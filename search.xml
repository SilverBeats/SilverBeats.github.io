<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Mybatis</title>
      <link href="Mybatis/"/>
      <url>Mybatis/</url>
      
        <content type="html"><![CDATA[<h1 id="1-简介"><a class="markdownIt-Anchor" href="#1-简介"></a> 1. 简介</h1><h2 id="11-什么是mybatis"><a class="markdownIt-Anchor" href="#11-什么是mybatis"></a> 1.1 什么是Mybatis</h2><ul><li><p>MyBatis<strong>本是apache</strong>的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且<strong>改名为MyBatis</strong> 。2013年11月<strong>迁移到Github</strong></p></li><li><p>MyBatis 是一款优秀的<strong>持久层框架</strong></p></li><li><p>它支持自定义 SQL、存储过程以及高级映射。</p></li><li><p>MyBatis免除了几乎所有的 JDBC代码以及设置参数和获取结果集的工作。MyBatis可以通过简单的XML或注解来配置和映射原始类型、接口和 Java的POJO（Plain Old Java Objects，普通老式 Java 对象）为数据库中的记录。</p></li></ul><h2 id="12-获得mybatis"><a class="markdownIt-Anchor" href="#12-获得mybatis"></a> 1.2 获得Mybatis</h2><ul><li>Maven仓库</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><a href="#https://github.com/mybatis/mybatis-3/releases">GitHub</a></li><li><a href="#https://mybatis.org/mybatis-3/zh/getting-started.html">中文文档</a></li></ul><h2 id="12-使用mybatis的原因"><a class="markdownIt-Anchor" href="#12-使用mybatis的原因"></a> 1.2 使用Mybatis的原因</h2><ul><li>简单易学：本身就很小且简单。没有任何第三方依赖，最简单安装只要两个jar文件+配置几个sql映射文件易于学习，易于使用，通过文档和源代码，可以比较完全的掌握它的设计思路和实现。</li><li>灵活：mybatis不会对应用程序或者数据库的现有设计强加任何影响。 sql写在xml里，便于统一管理和优化。通过sql语句可以满足操作数据库的所有需求。</li><li>解除sql与程序代码的耦合：通过提供DAO层，将业务逻辑和数据访问逻辑分离，使系统的设计更清晰，更易维护，更易单元测试。sql和代码的分离，提高了可维护性。</li><li>提供映射标签，支持对象与数据库的orm字段关系映射</li><li>提供对象关系映射标签，支持对象关系组建维护</li><li>提供xml标签，支持编写动态sql</li></ul><h1 id="2-第一个mybatis程序"><a class="markdownIt-Anchor" href="#2-第一个mybatis程序"></a> 2. 第一个Mybatis程序</h1><h2 id="21-环境搭建"><a class="markdownIt-Anchor" href="#21-环境搭建"></a> 2.1 环境搭建</h2><ul><li>搭建数据库</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`mybatistest`</span>;</span><br><span class="line"><span class="keyword">USE</span> <span class="string">`mybatistest`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line"><span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line"><span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="string">`pwd`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`user`</span> <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;123456&quot;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&quot;李四&quot;</span>, <span class="string">&quot;1234567&quot;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&quot;王五&quot;</span>, <span class="string">&quot;1234568&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li><p>创建Maven项目</p></li><li><p>删除src目录</p></li><li><p>导入Maven依赖</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mysql驱动--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--Junit--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="22-创建一个模块"><a class="markdownIt-Anchor" href="#22-创建一个模块"></a> 2.2 创建一个模块</h2><ul><li>在resources文件夹下，创建Mybatis核心配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--configuration核心配置文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--多个环境--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开发环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--事务管理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据库相关--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatistest?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>serverTimezone=Asia/Shanghai&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>编写Mybatis的工具类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.silverbeats.utils;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtil</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">  <span class="comment">// 使用Mybatis第一步：获取SQLSessionFactory对象</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      String resource = <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">      InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">      sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//既然有了 SqlSessionFactory，顾名思义，我们可以从中获得 SqlSession 的实例。</span></span><br><span class="line">  <span class="comment">//SqlSession 提供了在数据库执行 SQL 命令所需的所有方法。你可以通过 SqlSession</span></span><br><span class="line">  <span class="comment">//实例来直接执行已映射的 SQL 语句</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="23-编写代码"><a class="markdownIt-Anchor" href="#23-编写代码"></a> 2.3 编写代码</h2><ul><li>实体类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.silverbeats.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String pwd;</span><br><span class="line">  <span class="comment">// 以及空参、有参、get、set、toString方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Dao接口</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接口实现类</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--命名空间 绑定一个对应的dao接口也就是mapper接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.silverbeats.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--id对应绑定接口的方法,resultType返回类型要写全类名--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span>&gt;</span></span><br><span class="line">  select * from mybatistest.user</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="24-junit测试"><a class="markdownIt-Anchor" href="#24-junit测试"></a> 2.4 Junit测试</h2><p>根据上面的内容进行测试一定出现下面的异常</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">绑定异常</span><br><span class="line">org.apache.ibatis.binding.BindingException: Type interface com.silverbeats.dao.UserMapper is not known to the MapperRegistry</span><br></pre></td></tr></table></figure><p>这是因为在Maybatis核心配置文件中缺少内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--每一个Mapper.xml都需要在Mybatis核心配置文件中注册,这里就是MapperRegistry--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/silverbeats/dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><p>但是运行单元测试还是会出现下面的异常，表示找不到配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">java.lang.ExceptionInInitializerError</span><br><span class="line">at com.silverbeats.dao.UserMapperTest.test(UserMapperTest.java:15)</span><br><span class="line">……</span><br><span class="line">Caused by: org.apache.ibatis.exceptions.PersistenceException: </span><br><span class="line">### Error building SqlSession.</span><br><span class="line">### The error may exist in com&#x2F;silverbeats&#x2F;dao&#x2F;UserMapper.xml</span><br><span class="line">### Cause: org.apache.ibatis.builder.BuilderException: Error parsing SQL Mapper Configuration. Cause: java.io.IOException: Could not find resource com&#x2F;silverbeats&#x2F;dao&#x2F;UserMapper.xml</span><br></pre></td></tr></table></figure><p>这是因为Maven项目中资源导出的问题，需要在父工程或者子工程的pom.xml导入如下代码（保险起见都父子工程导入）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 获得SqlSession对象</span></span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 方式一：执行sql</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    List&lt;User&gt; userList = userMapper.getUserList();</span><br><span class="line">    <span class="comment">// 方法2</span></span><br><span class="line">    <span class="comment">// List&lt;User&gt; userList = sqlSession.selectList(&quot;com.silverbeats.dao.UserMapper.getUserList&quot;);</span></span><br><span class="line"><span class="comment">// 打印数据</span></span><br><span class="line">    <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">      System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// 关闭SqlSession</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="25-总结"><a class="markdownIt-Anchor" href="#25-总结"></a> 2.5 总结</h2><p>上面的第一个程序中，一共创建了6个文件</p><ul><li>子工程resources/mybatis-config.xml Mybatis核心配置文件</li><li>子工程java目录下建包，dao目录下User实体类对应的接口UserMapper</li><li>dao目录下实体类接口UserMapper对应的配置文件UserMapper.xml，并且每个xml配置文件都需要在Mybatis核心配置文件中进行注册</li><li>pojo目录下，User实体类，JavaBean</li><li>utils目录下，MybatisUtil工具类，加载核心配置文件，返回sqlSession</li><li>test目录下，对应目录结构，创建了Junit测试类</li></ul><p>其中，在后期使用过程中，有一些文件是不需要修改的：</p><ol><li>MybatisUtil类不需要修改</li><li>User实体类不需要变动，除非数据库对应的字段发生变化</li></ol><p>当需要向数据库添加新的表时，只需要在dao目录下创建对应的Mapper、Mapper.xml并在Mybatis-config.xml进行注册，以及pojo下的实体类即可</p><h1 id="3-crud"><a class="markdownIt-Anchor" href="#3-crud"></a> 3. CRUD</h1><p>在UserMapper.xml书写sql，进行CRUD</p><h2 id="31-select标签"><a class="markdownIt-Anchor" href="#31-select标签"></a> 3.1 select标签</h2><ul><li><p>编写接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询全部用户</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 根据id查询用户</span></span><br><span class="line"><span class="function">User <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>编写对应Mapper.xml的sql</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--普通查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span>&gt;</span></span><br><span class="line">  select * from mybatistest.user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--带有条件的查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">  select * from mybatistest.user where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>id 绑定的namespace中的方法名</li><li>resultType sql语句执行的返回值</li><li>parameterType 参数类型</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">  User user = userMapper.getUserById(<span class="number">2</span>);</span><br><span class="line">  System.out.println(user);</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="32-insert标签"><a class="markdownIt-Anchor" href="#32-insert标签"></a> 3.2 insert标签</h2><ul><li><p>编写接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入用户</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除用户</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>编写对应Mapper.xml的sql</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span>&gt;</span></span><br><span class="line">  insert into mybatistest.user (id, name, pwd) values(#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> res = userMapper.addUser(<span class="keyword">new</span> User(<span class="number">4</span>, <span class="string">&quot;胡娜&quot;</span>, <span class="string">&quot;asdf&quot;</span>));</span><br><span class="line">  <span class="comment">// 插入成功，提交事务</span></span><br><span class="line">  <span class="keyword">if</span>(res &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    sqlSession.commit();</span><br><span class="line">  &#125;</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="33-update标签"><a class="markdownIt-Anchor" href="#33-update标签"></a> 3.3 update标签</h2><ul><li><p>编写接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改用户</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>编写对应Mapper.xml的sql</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span>&gt;</span></span><br><span class="line">  update mybatistest.user set name=#&#123;name&#125;, pwd=#&#123;pwd&#125; where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">int</span> res = userMapper.updateUser(<span class="keyword">new</span> User(<span class="number">4</span>, <span class="string">&quot;胡娜12&quot;</span>, <span class="string">&quot;asdf&quot;</span>));</span><br><span class="line">  <span class="comment">// 更新成功，提交事务</span></span><br><span class="line">  <span class="keyword">if</span>(res &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    sqlSession.commit();</span><br><span class="line">  &#125;</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="34-delete标签"><a class="markdownIt-Anchor" href="#34-delete标签"></a> 3.4 delete标签</h2><ul><li><p>编写接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除用户</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure></li><li><p>编写对应Mapper.xml的sql</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">  delete from mybatistest.user where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> res = userMapper.deleteUser(<span class="number">4</span>);</span><br><span class="line">  <span class="comment">// 插入成功，提交事务</span></span><br><span class="line">  <span class="keyword">if</span>(res &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    sqlSession.commit();</span><br><span class="line">  &#125;</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="35-map"><a class="markdownIt-Anchor" href="#35-map"></a> 3.5 Map</h2><p>倘若实体类或者数据库中的表字段过多，可以考虑使用Map集合来解决</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用map插入用户</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addUser2</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--通过map添加--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addUser2&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">  insert into mybatistest.user (id, name, pwd) values(#&#123;userid&#125;, #&#123;userName&#125;, #&#123;password&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">  HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">  map.put(<span class="string">&quot;userid&quot;</span>, <span class="number">7</span>);</span><br><span class="line">  map.put(<span class="string">&quot;userName&quot;</span>, <span class="string">&quot;呼啦啦&quot;</span>);</span><br><span class="line">  map.put(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;lliiww&quot;</span>);</span><br><span class="line">  userMapper.addUser2(map);</span><br><span class="line">  </span><br><span class="line">  sqlSession.commit();</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Map传递参数，直接在sql中取出对应的key即可，parameterType=“map”</p><p>对象传递参数，直接在sql中取对象的属性即可，parameterType=“com.silverbeats.pojo.User”</p><p>在只有一个基本类型参数的情况下，可以直接在sql中取到</p><p>多个参数用Map，或者<strong>注解</strong></p><h1 id="4-配置解析"><a class="markdownIt-Anchor" href="#4-配置解析"></a> 4. 配置解析</h1><p><a href="https://mybatis.org/mybatis-3/zh/configuration.html">配置文档</a></p><h2 id="41-核心配置文件mybatis-configxml"><a class="markdownIt-Anchor" href="#41-核心配置文件mybatis-configxml"></a> 4.1 核心配置文件mybatis-config.xml</h2><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/核心配置文件目录.png"><p><strong>标签书写顺序</strong></p><p>The content of element type “configuration” must match “(properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,objectWrapperFactory?,reflectorFactory?,plugins?,environments?,databaseIdProvider?,mappers?)”.</p><h2 id="42-properties-属性"><a class="markdownIt-Anchor" href="#42-properties-属性"></a> 4.2 properties 属性</h2><p>可以通过properties 属性来实现引用配置文件</p><p>这些属性可以在外部进行配置，并可以进行动态替换。既可以在典型的 Java 属性文件中配置这些属性，也可以在 properties 元素的子元素中设置</p><p>在[上面的程序](#2. 第一个Mybatis程序)的核心配置文件中，可以将其中的driver、url、username、password写到properties文件中</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatistest?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><p>然后在核心配置文件中引入该properties文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--引入外部配置文件--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--每一个Mapper.xml都需要在Mybatis核心配置文件中注册--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/silverbeats/dao/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>同时properties标签内可以使用property标签来添加属性，比如将username和password用property传递，url和driver用properties文件</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatistest?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样也可以达到相同的效果。</p><p>倘若是下面这种情况</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1234&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><p>会优先使用properties文件中的password值</p><h2 id="43-settings-设置"><a class="markdownIt-Anchor" href="#43-settings-设置"></a> 4.3 settings 设置</h2><p><a href="https://mybatis.org/mybatis-3/zh/configuration.html#settings">settings 设置文档</a></p><h2 id="44-typealiases-类型别名"><a class="markdownIt-Anchor" href="#44-typealiases-类型别名"></a> 4.4 typeAliases 类型别名</h2><p>在核心配置文件中给实体类起别名，这样，可以在Mapper.xml中的resultType和parameterType直接使用这个别名即可，而不需要写全类名</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--给实体类起别名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.silverbeats.pojo.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;User&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><p>也可以指定一个包名，Mybatis会在包名下面搜索需要的JavaBean，在没有注解的情况下，扫描到的Bean别名模式是类名小写</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.silverbeats.pojo&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><p>第三种起别名方式为加注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Alias(&quot;hulala&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>上面三个方式都可以给实体类起别名，优先级不同，第一种直接给实体类起别名优先级最高，其次是注解，最后是指定包名给实体类起别名</p></blockquote><h2 id="45-environments-环境变量"><a class="markdownIt-Anchor" href="#45-environments-环境变量"></a> 4.5 environments 环境变量</h2><p>MyBatis 可以配置成适应多种环境，<strong>尽管可以配置多个环境，但每个 SqlSessionFactory 实例只能选择一种环境</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--通过修改default的值来切换环境--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;...&quot;</span> <span class="attr">value</span>=<span class="string">&quot;...&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>transactionManager事务管理器</p><ul><li>JDBC 默认</li><li>MANAGED</li></ul></li><li><p>dataSource数据源，dataSource元素使用标准的 JDBC 数据源接口来配置 JDBC 连接对象的资源，三种内建的数据源类型</p><ul><li><p>UNPOOLED</p><blockquote><p>这个数据源的实现会每次请求时打开和关闭连接。虽然有点慢，但对那些数据库连接可用性要求不高的简单应用程序来说，是一个很好的选择。 性能表现则依赖于使用的数据库，对某些数据库来说，使用连接池并不重要，这个配置就很适合这种情形</p></blockquote></li><li><p>POOLED 默认</p><blockquote><p>这种数据源的实现利用“池”的概念将 JDBC 连接对象组织起来，避免了创建新的连接实例时所必需的初始化和认证时间。 这种处理方式很流行，能使并发 Web 应用快速响应请求</p></blockquote></li><li><p>JNDI</p><blockquote><p>这个数据源实现是为了能在如 EJB 或应用服务器这类容器中使用，容器可以集中或在外部配置数据源，然后放置一个 JNDI 上下文的数据源引用</p></blockquote></li></ul></li></ul><h2 id="46-映射器mappers"><a class="markdownIt-Anchor" href="#46-映射器mappers"></a> 4.6 映射器Mappers</h2><p>既然 MyBatis 的行为已经由上述元素配置完了，我们现在就要来定义 SQL 映射语句了。 但首先，我们需要告诉 MyBatis 到哪里去找到这些语句。 在自动查找资源方面，Java 并没有提供一个很好的解决方案，所以最好的办法是直接告诉 MyBatis 到哪里去找映射文件。 你可以使用相对于类路径的资源引用，或完全限定资源定位符（包括 <code>file:///</code> 形式的 URL），或类名和包名等。例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用相对于类路径的资源引用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/AuthorMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/BlogMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;org/mybatis/builder/PostMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用完全限定资源定位符（URL） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">&quot;file:///var/mappers/AuthorMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">&quot;file:///var/mappers/BlogMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">url</span>=<span class="string">&quot;file:///var/mappers/PostMapper.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><p>下面两个方法需要注意：</p><ul><li>接口和它的Mapper配置文件必须同名</li><li>接口和它的Mapper配置文件必须同包</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用映射器接口实现类的完全限定类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.AuthorMapper&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.BlogMapper&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.builder.PostMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 将包内的映射器接口实现全部注册为映射器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;org.mybatis.builder&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="47-其他"><a class="markdownIt-Anchor" href="#47-其他"></a> 4.7 其他</h2><ul><li><p>typeHandlers 类型处理器</p></li><li><p>objectFactory 对象工厂</p></li><li><p>plugins 插件</p><ul><li>Mybatis-generator-core</li><li>Mybatis-plus</li><li>通用mapper</li></ul></li></ul><h1 id="5-生命周期和作用域"><a class="markdownIt-Anchor" href="#5-生命周期和作用域"></a> 5. 生命周期和作用域</h1><p>作用域和生命周期类别是至关重要的，因为错误的使用会导致非常严重的<strong>并发问题</strong></p><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/生命周期和作用域.png"><p><strong>对象生命周期和依赖注入框架</strong></p><p>依赖注入框架可以创建线程安全的、基于事务的 SqlSession 和映射器，并将它们直接注入到你的 bean 中，因此可以直接忽略它们的生命周期。 如果对如何通过依赖注入框架使用 MyBatis 感兴趣，可以研究一下 MyBatis-Spring 或 MyBatis-Guice 两个子项目。</p><h2 id="51-sqlsessionfactorybuilder"><a class="markdownIt-Anchor" href="#51-sqlsessionfactorybuilder"></a> 5.1 SqlSessionFactoryBuilder</h2><ul><li>可实例化</li><li>一旦创建了 SqlSessionFactory，就不再需要它了</li><li><strong>作用域：局部变量</strong></li></ul><h2 id="52-sqlsessionfactory"><a class="markdownIt-Anchor" href="#52-sqlsessionfactory"></a> 5.2 SqlSessionFactory</h2><ul><li>一旦创建，一直存在</li><li>可以想象为：数据库连接池</li><li>单例模式或静态单例模式</li><li><strong>作用域：全局作用域</strong></li></ul><h2 id="53-sqlsession"><a class="markdownIt-Anchor" href="#53-sqlsession"></a> 5.3 SqlSession</h2><ul><li>每个线程都应该有它自己的 SqlSession 实例，可以理解为连接到连接池的一个请求，需要自行请求和关闭</li><li>SqlSession 的实例不是线程安全的，因此是不能被共享的</li><li><strong>用完就关闭</strong>，否则会出现资源占用</li><li><strong>最佳的作用域是请求或方法作用域</strong></li></ul><h1 id="6-解决属性名和字段名不一致的问题"><a class="markdownIt-Anchor" href="#6-解决属性名和字段名不一致的问题"></a> 6. 解决属性名和字段名不一致的问题</h1><p>当实体类中的私有属性，比如password，而在数据库中对应的字段名是pwd，倘若通过id查询，是不会获得对应的值的。</p><p>因为在Mapper.xml中对应的sql是这样写的：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> mybatistest.user <span class="keyword">where</span> <span class="keyword">id</span> = <span class="comment">#&#123;id&#125;;</span></span><br><span class="line"><span class="comment">-- 实际上是：</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,pwd <span class="keyword">from</span> mybatistest.user <span class="keyword">where</span> <span class="keyword">id</span> = <span class="comment">#&#123;id&#125;;</span></span><br><span class="line"><span class="comment">-- 目标就是，如何将查询到的pwd值给到password</span></span><br></pre></td></tr></table></figure><p>解决方法</p><ul><li>起别名</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,pwd <span class="keyword">as</span> <span class="keyword">password</span> <span class="keyword">from</span> mybatistest.user <span class="keyword">where</span> <span class="keyword">id</span> = <span class="comment">#&#123;id&#125;;</span></span><br></pre></td></tr></table></figure><ul><li>resultMap结果集映射，在Mapper.xml中写</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--column和property值一样，可省略--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--column对应数据库的列--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--property对应实体类的属性值--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> /&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!--column和property值一样，可省略--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--此时不需要resultType--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">select * from mybatistest.user where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="7-日志"><a class="markdownIt-Anchor" href="#7-日志"></a> 7. 日志</h1><h2 id="71-日志工厂"><a class="markdownIt-Anchor" href="#71-日志工厂"></a> 7.1 日志工厂</h2><p>如果一个数据库操作出现异常，需要排错，日志就是最好的助手。</p><p>在核心配置文件中配置logImpl，指定 MyBatis 所用日志的具体实现，未指定时将自动查找。</p><ul><li>SLF4J</li><li>LOG4J 【掌握】【需要导包】</li><li>LOG4J2</li><li>JDK_LOGGING</li><li>COMMONS_LOGGING</li><li>STDOUT_LOGGING【掌握】【可以直接用】</li><li>NO_LOGGING</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="72-log4j"><a class="markdownIt-Anchor" href="#72-log4j"></a> 7.2 LOG4J</h2><ul><li><p>Log4j是Apache的一个开源项目，通过使用Log4j，我们可以控制日志信息输送的目的地是控制台、文件、GUI组件，甚至是套接口服务器、NT的事件记录器、UNIXSyslog守护进程等；</p></li><li><p>可以控制每一条日志的输出格式</p></li><li><p>可以定义每一条日志信息的级别，能够更加细致地控制日志的生成过程</p></li><li><p>通过一个配置文件来灵活地进行配置，而不需要修改应用的代码。</p></li></ul><ol><li>导入LOG4J包</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>log4j.properties</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将登记为DEBUG的日志信息输出到console和file两个目的地</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">debug,console,file</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#控制台输出的相关配置</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.console.Target</span> = <span class="string">System.out </span></span><br><span class="line"><span class="meta">log4j.appender.console.Threshold</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.ConversionPattern</span> = <span class="string">[%c]-%m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#文件输出相关配置</span></span><br><span class="line"><span class="meta">log4j.appender.file</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span> = <span class="string">./logs/log.log</span></span><br><span class="line"><span class="meta">log4j.appender.file.MaxFileSize</span> = <span class="string">10mb</span></span><br><span class="line"><span class="comment">##输出DEBUG级别以上的日志</span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志输出级别</span></span><br><span class="line"><span class="meta">log4j.logger.org.mybatis</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PrepareStatement</span>= <span class="string">DEBUG</span></span><br></pre></td></tr></table></figure><ol start="3"><li>配置核心文件</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span></span></span><br><span class="line">&lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="8-分页"><a class="markdownIt-Anchor" href="#8-分页"></a> 8. 分页</h1><h2 id="81-limit分页"><a class="markdownIt-Anchor" href="#81-limit分页"></a> 8.1 limit分页</h2><p>分页的原因：减少数据的处理量，提高效率</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> 表 <span class="keyword">limit</span> startIndex, pageSize;</span><br></pre></td></tr></table></figure><ol><li>接口</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试分页</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">(Map&lt;String, Integer&gt; map)</span></span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>Mapper.xml</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUsers&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">select * from mybatistest.user limit #&#123;startIndex&#125;, #&#123;pageSize&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>测试</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">  HashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">  map.put(<span class="string">&quot;startIndex&quot;</span>, <span class="number">1</span>);</span><br><span class="line">  map.put(<span class="string">&quot;pageSize&quot;</span>, <span class="number">2</span>);</span><br><span class="line">  List&lt;User&gt; userList = userMapper.getUsers(map);</span><br><span class="line">  <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">  logger.info(user);</span><br><span class="line">  &#125;</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="82-rowbounds分页"><a class="markdownIt-Anchor" href="#82-rowbounds分页"></a> 8.2 RowBounds分页</h2><ol><li>接口</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用RowBounds查询</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUsersByRowBounds</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>Mapper.xml</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUsers&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;UserMap&quot;</span>&gt;</span></span><br><span class="line">select * from mybatistest.user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>测试</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRoundBounds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line"><span class="comment">// RowBounds实现</span></span><br><span class="line">RowBounds rowBounds = <span class="keyword">new</span> RowBounds(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// 通过java代码层面实现分页</span></span><br><span class="line">List&lt;User&gt; selectList = sqlSession.selectList(<span class="string">&quot;com.silverbeats.dao.UserMapper.getUsersByRowBounds&quot;</span>,<span class="keyword">null</span>, rowBounds);</span><br><span class="line"><span class="keyword">for</span> (User user : selectList) &#123;</span><br><span class="line">logger.info(user);</span><br><span class="line">&#125;</span><br><span class="line">sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="83-分页插件"><a class="markdownIt-Anchor" href="#83-分页插件"></a> 8.3 分页插件</h2><p><a href="#https://pagehelper.github.io/docs/howtouse/">pagehelper</a></p><h1 id="9-使用注解"><a class="markdownIt-Anchor" href="#9-使用注解"></a> 9. 使用注解</h1><p><strong>接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 方法存在多个参数,所有参数前面必须要有@Param</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function">User <span class="title">getUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line"><span class="comment">// 插入用户</span></span><br><span class="line"><span class="meta">@Select(&quot;insert into mybatistest.user (id, name, pwd) values(#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;)&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertUser</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="keyword">int</span> id, <span class="meta">@Param(&quot;name&quot;)</span> String name,<span class="meta">@Param(&quot;pwd&quot;)</span> String password)</span></span>;</span><br><span class="line"><span class="meta">@Select(&quot;insert into mybatistest.user (id, name, pwd) values(#&#123;id&#125;, #&#123;name&#125;, #&#123;password&#125;)&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"><span class="comment">// 更新</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set name = #&#123;name&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/注解.png"><p>@Param()注解</p><ul><li>基本类型的参数或者String类型，需要加上注解</li><li>如果只有一个基本类型，可以忽略</li><li>引用类型不需要加</li><li>在sql引用的就是这里设定的属性名</li></ul><p><strong>核心配置xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--绑定接口--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.silverbeats.dao.UserMapper&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="10-lombok"><a class="markdownIt-Anchor" href="#10-lombok"></a> 10. Lombok</h1><p>Lombok项目是一个Java库，它会自动插入您的编辑器和构建工具中，从而使您的Java更加生动有趣。永远不要再写另一个getter或equals方法，带有一个注释的您的类有一个功能全面的生成器，自动执行记录变量等。</p><ul><li>idea中安装插件</li><li>项目中导入lombok的jar包</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@data: 可以添加无参构造、get、set、toString、hashCode、equals</span><br><span class="line">@ToString: 重写toString方法</span><br><span class="line">@AllArgsConstructor: 添加有参构造</span><br><span class="line">@NoArgsConstructor: 添加无参构造</span><br><span class="line">@EqualsAndHashCode: 添加hashCode、equals方法</span><br></pre></td></tr></table></figure><h1 id="11-复杂查询环境"><a class="markdownIt-Anchor" href="#11-复杂查询环境"></a> 11. 复杂查询环境</h1><ul><li>搭建环境，创建学生表和老师表</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`teacher`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher(<span class="string">`id`</span>, <span class="string">`name`</span>) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;乌拉拉&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`tid`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`fktid`</span> (<span class="string">`tid`</span>),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">`fktid`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`tid`</span>) <span class="keyword">REFERENCES</span> <span class="string">`teacher`</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`student`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`student`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`student`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;小张&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`student`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;小李&#x27;</span>, <span class="string">&#x27;1&#x27;</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`student`</span> (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;小王&#x27;</span>, <span class="string">&#x27;1&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="111-多对一"><a class="markdownIt-Anchor" href="#111-多对一"></a> 11.1 多对一</h2><p>多个学生关联一个老师</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Teacher teacher;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在mybatis实现下面的sql</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student s, teacher t <span class="keyword">where</span> s.tid = t.id;</span><br></pre></td></tr></table></figure><p>①先获取所有学生的信息</p><p>②根据学生的tid获取对应老师的信息</p><p><strong>按照查询嵌套</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentInfo&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;studentTeacher&quot;</span>&gt;</span></span><br><span class="line">  select * from student;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;studentTeacher&quot;</span> <span class="attr">type</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getTeacher&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacher&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;teacher&quot;</span>&gt;</span></span><br><span class="line">  select * from teacher where id = #&#123;tid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>按照结果嵌套</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentInfo2&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;studentTeacher2&quot;</span>&gt;</span></span><br><span class="line">  select s.id sid, s.name sname, t.name tname</span><br><span class="line">  from student s, teacher t</span><br><span class="line">  where s.tid = t.id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;studentTeacher2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teacher&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;teacher&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="112-一对多"><a class="markdownIt-Anchor" href="#112-一对多"></a> 11.2 一对多</h2><p>一个老师关联多个学生</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> tid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取指定老师下的学生信息和老师信息</span></span><br><span class="line"><span class="function">Teacher <span class="title">getTeacherById</span><span class="params">(<span class="meta">@Param(&quot;tid&quot;)</span> <span class="keyword">int</span> id)</span></span>;</span><br></pre></td></tr></table></figure><p><strong>按照结果嵌套</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--获取指定老师下的学生信息和老师信息--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacherById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;teacherStudent&quot;</span>&gt;</span></span><br><span class="line">  select s.id sid, s.name sname, t.name tname, t.id tid</span><br><span class="line">  from student s, teacher t</span><br><span class="line">  where s.tid = tid and tid = #&#123;tid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;teacherStudent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;teacher&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tname&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;tid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;tid&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>按照查询嵌套</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getTeacherById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;teacherStudent&quot;</span>&gt;</span></span><br><span class="line">  select * from teacher where id = #&#123;tid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;teacherStudent&quot;</span> <span class="attr">type</span>=<span class="string">&quot;teacher&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;students&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;ArrayList&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;student&quot;</span> <span class="attr">select</span>=<span class="string">&quot;getStudentsByTeacherId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getStudentsByTeacherId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;student&quot;</span>&gt;</span></span><br><span class="line">  select * from student where tid = #&#123;tid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="12-动态sql"><a class="markdownIt-Anchor" href="#12-动态sql"></a> 12. 动态sql</h1><p>根据不同的条件生成不同的sql</p><ul><li>环境</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`blog`</span>(</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;博客id&#x27;</span>,</span><br><span class="line">  <span class="string">`title`</span> <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;博客标题&#x27;</span>,</span><br><span class="line">  <span class="string">`author`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;博客作者&#x27;</span>,</span><br><span class="line">  <span class="string">`create_time`</span> DATETIME <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  <span class="string">`views`</span> <span class="built_in">INT</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;浏览量&#x27;</span></span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBlog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  BlogMapper mapper = sqlSession.getMapper(BlogMapper.class);</span><br><span class="line">  Blog blog = <span class="keyword">new</span> Blog();</span><br><span class="line">  blog.setId(IDUtils.getID());</span><br><span class="line">  blog.setTitle(<span class="string">&quot;Mybatis&quot;</span>);</span><br><span class="line">  blog.setAuthor(<span class="string">&quot;狂神说&quot;</span>);</span><br><span class="line">  blog.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">  blog.setViews(<span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">  mapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">  blog.setId(IDUtils.getID());</span><br><span class="line">  blog.setTitle(<span class="string">&quot;Java&quot;</span>);</span><br><span class="line">  mapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">  blog.setId(IDUtils.getID());</span><br><span class="line">  blog.setTitle(<span class="string">&quot;Spring&quot;</span>);</span><br><span class="line">  mapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">  blog.setId(IDUtils.getID());</span><br><span class="line">  blog.setTitle(<span class="string">&quot;微服务&quot;</span>);</span><br><span class="line">  mapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.silverbeats.dao.BlogMapper&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addBlog&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">    insert into blog(id, title, author, create_time, views)</span><br><span class="line">    values(#&#123;id&#125;,#&#123;title&#125;,#&#123;author&#125;,#&#123;createTime&#125;,#&#123;views&#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>实体类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String id;</span><br><span class="line"><span class="keyword">private</span> String author;</span><br><span class="line"><span class="keyword">private</span> String title;</span><br><span class="line"><span class="keyword">private</span> Date createTime;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> view;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="121-if"><a class="markdownIt-Anchor" href="#121-if"></a> 12.1 iF</h2><ul><li>接口</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询blog</span></span><br><span class="line"><span class="function">List&lt;Blog&gt; <span class="title">queryBlogIF</span><span class="params">(Map map)</span></span>;</span><br></pre></td></tr></table></figure><ul><li>Mapper.xml</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogIF&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">  select * from blog where 1=1</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">    and title = #&#123;title&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">    and author = #&#123;author&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>测试</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  BlogMapper mapper = sqlSession.getMapper(BlogMapper.class);</span><br><span class="line">  HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  map.put(<span class="string">&quot;title&quot;</span>, <span class="string">&quot;Spring&quot;</span>);</span><br><span class="line">  List&lt;Blog&gt; blogs = mapper.queryBlogIF(map);</span><br><span class="line">  <span class="keyword">for</span> (Blog blog : blogs) &#123;</span><br><span class="line">    System.out.println(blog);</span><br><span class="line">  &#125;</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="122-choosewhen-otherwise"><a class="markdownIt-Anchor" href="#122-choosewhen-otherwise"></a> 12.2 choose(when、otherwise)</h2><p><em>choose</em>标签，当满足第一个when的条件就不会再往下走了</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试choose--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogChoose&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">  select * from blog</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span>title = #&#123;title&#125;<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span>and author = #&#123;author&#125;<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span>and views = #&#123;views&#125;<span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="123-trimwhere-set"><a class="markdownIt-Anchor" href="#123-trimwhere-set"></a> 12.3 trim（where、set）</h2><p><em>where</em> 元素<mark>只会在子元素返回任何内容的情况下才插入 “WHERE” 子句</mark>。而且，若子句的开头为 “AND” 或 “OR”，<em>where</em> 元素也会将它们去除。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试where--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogChoose&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">  select * from blog</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span>title = #&#123;title&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span>and author = #&#123;author&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><em>set</em> 元素会动态地在行首插入 SET 关键字，并会删掉额外的逗号（这些逗号是在使用条件语句给列赋值时引入的）。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试set--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBlog&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">  update blog</span><br><span class="line">  <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span>title = #&#123;title&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span>author = #&#123;author&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="124-foreach"><a class="markdownIt-Anchor" href="#124-foreach"></a> 12.4 foreach</h2><p><em>foreach</em> 元素的功能非常强大，它允许你指定一个集合，声明可以在元素体内使用的集合项（item）和索引（index）变量。它也允许你指定开头与结尾的字符串以及集合项迭代之间的分隔符。这个元素也不会错误地添加多余的分隔符，看它多智能！</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试foreach--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryForeach&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;ArrayList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">  select * </span><br><span class="line">  from blog</span><br><span class="line">  where views in</span><br><span class="line">  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">    #&#123;item&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>实质：循环字符串拼接</p><ul><li>collection：需要遍历的集合</li><li>item：被遍历集合的每个元素</li><li>index：被遍历元素的索引</li><li>open：开始的字符</li><li>close：结束的字符</li><li>separator：分隔符</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试foreach</span></span><br><span class="line"><span class="function">List&lt;Blog&gt; <span class="title">queryForeach</span><span class="params">(<span class="meta">@Param(&quot;list&quot;)</span> List&lt;Integer&gt; list)</span></span>;</span><br><span class="line"><span class="comment">/*----------------------------------------------------------*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestForeach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  BlogMapper mapper = sqlSession.getMapper(BlogMapper.class);</span><br><span class="line">  ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">  list.add(<span class="number">1000</span>);</span><br><span class="line">  list.add(<span class="number">2000</span>);</span><br><span class="line">  list.add(<span class="number">7000</span>);</span><br><span class="line">  List&lt;Blog&gt; blogs = mapper.queryForeach(list);</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="125-sql片段"><a class="markdownIt-Anchor" href="#125-sql片段"></a> 12.5 sql片段</h2><p>有的时候，会将公共的部分抽取出来，方便反复使用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试sql片段--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;if_title_author&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;title != null&quot;</span>&gt;</span></span><br><span class="line">    and title = #&#123;title&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;author != null&quot;</span>&gt;</span></span><br><span class="line">    and author = #&#123;author&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--测试where--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryBlogWhere&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;blog&quot;</span>&gt;</span></span><br><span class="line">  select * from blog</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;if_title_author&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>最好基于单表来定义sql片段</li><li>sql片段中不要存在where标签</li></ul><h1 id="13-缓存"><a class="markdownIt-Anchor" href="#13-缓存"></a> 13. 缓存</h1><p>读写分离，主从复制</p><p>经常查询并且不经常改变的数据可以使用缓存</p><h2 id="131-mybatis的缓存"><a class="markdownIt-Anchor" href="#131-mybatis的缓存"></a> 13.1 Mybatis的缓存</h2><ul><li>Mybatis包含了一个非常强大的查询缓存特性，它可以非常方便地定制和配置缓存，缓存可以极大地提升查询效率</li><li>Mybatis系统中默认定义了两级缓存：<strong>一级缓存和二级缓存</strong><ul><li>默认情况下，只有一级缓存开启，（SqlSession级别的缓存，也称为本地缓存）</li><li>二级缓存需要手动开启和配置，他是基于namespace级别的缓存</li><li>为了提高扩展性，Mybatis定义了缓存接口Cache，可以通过实现Cache接口来自定义二级缓存</li></ul></li></ul><h2 id="132-一级缓存"><a class="markdownIt-Anchor" href="#132-一级缓存"></a> 13.2 一级缓存</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">  User user1 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  User user2 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98.png" alt="" /></p><p>可以看到，只有一次SQL查询，并且user1和user2是同一个对象</p><p>缓存失效的情况</p><ul><li><p>查询不同的东西</p></li><li><p>增删改操作，可能会改编原来的数据，所以会刷新缓存</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">  User user1 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;更新id=2的用户&quot;</span>);</span><br><span class="line">  HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  map.put(<span class="string">&quot;id&quot;</span>, <span class="number">2</span>);</span><br><span class="line">  map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;嗯哼2&quot;</span>);</span><br><span class="line">  mapper.updateUserById(map);</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  User user2 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  <img data-src="http://resource.silverbeats.cn/static/images/Mybatis/缓存失效_更新.png"><ul><li><p>查询不同的Mapper.xml</p></li><li><p>手动清理缓存</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession = MybatisUtil.getSqlSession();</span><br><span class="line">  UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">  User user1 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;清理缓存&quot;</span>);</span><br><span class="line">  sqlSession.clearCache();</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  User user2 = mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">  sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>  <img data-src="http://resource.silverbeats.cn/static/images/Mybatis/缓存失效_更新.png"><h2 id="133-二级缓存"><a class="markdownIt-Anchor" href="#133-二级缓存"></a> 13.3 二级缓存</h2><p>二级缓存也称全局缓存，是基于namespace级别的缓存，一个名称空间对应一个二级缓存</p><p>工作机制</p><ul><li>一个会话查询一条数据，这个数据就会被放在当前会话的一级缓存中</li><li>如果当前会话关闭了，这个会话对应的一级缓存就没了，但是目标是：一级缓存消失，会将其中的数据保存到二级缓存中</li><li>新的会话查询信息，就可以从二级缓存中获取内容</li><li>不同的mapper查出的数据可以放在自己对应的缓存（map）中</li></ul><p><strong>步骤：</strong></p><ul><li>开启全局缓存</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>在Mapper.xml中添加cache标签</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">size</span>=<span class="string">&quot;512&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  SqlSession sqlSession1 = MybatisUtil.getSqlSession();</span><br><span class="line">  SqlSession sqlSession2 = MybatisUtil.getSqlSession();</span><br><span class="line"></span><br><span class="line">  UserMapper mapper1 = sqlSession1.getMapper(UserMapper.class);</span><br><span class="line">  UserMapper mapper2 = sqlSession2.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">  User user1 = mapper1.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;关闭sqlSession1&quot;</span>);</span><br><span class="line">  sqlSession1.close();</span><br><span class="line"></span><br><span class="line">  User user2 = mapper2.queryUserById(<span class="number">1</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;=================&quot;</span>);</span><br><span class="line">  System.out.println(user1);</span><br><span class="line">  System.out.println(user2);</span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">  sqlSession2.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/二级缓存.png"><p>这个更高级的配置创建了一个 FIFO 缓存，每隔 60 秒刷新，最多可以存储结果对象或列表的 512 个引用，而且返回的对象被认为是只读的，因此对它们进行修改可能会在不同线程中的调用者产生冲突。</p><p>可用的清除策略有：</p><ul><li><code>LRU</code> – 最近最少使用：移除最长时间不被使用的对象。</li><li><code>FIFO</code> – 先进先出：按对象进入缓存的顺序来移除它们。</li><li><code>SOFT</code> – 软引用：基于垃圾回收器状态和软引用规则移除对象。</li><li><code>WEAK</code> – 弱引用：更积极地基于垃圾收集器状态和弱引用规则移除对象。</li></ul><p>默认的清除策略是 LRU。</p><p>flushInterval（刷新间隔）属性可以被设置为任意的正整数，设置的值应该是一个以毫秒为单位的合理时间量。 默认情况是不设置，也就是没有刷新间隔，缓存仅仅会在调用语句时刷新。</p><p>size（引用数目）属性可以被设置为任意正整数，要注意欲缓存对象的大小和运行环境中可用的内存资源。默认值是 1024。</p><p>readOnly（只读）属性可以被设置为 true 或 false。只读的缓存会给所有调用者返回缓存对象的相同实例。 因此这些对象不能被修改。这就提供了可观的性能提升。而可读写的缓存会（通过序列化）返回缓存对象的拷贝。 速度上会慢一些，但是更安全，因此默认值是 false。</p><h2 id="134-缓存原理"><a class="markdownIt-Anchor" href="#134-缓存原理"></a> 13.4 缓存原理</h2><img data-src="http://resource.silverbeats.cn/static/images/Mybatis/缓存原理.png"><p><strong>缓存顺序：</strong></p><ul><li>先找二级缓存</li><li>再找一级缓存</li><li>最后查询数据库</li></ul>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
          <category> Mybatis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法设计与分析-动态规划</title>
      <link href="%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
      <url>%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
      
        <content type="html"><![CDATA[<p>动态规划和分治法类似，其基本思想也是将待求解问题分解成若干个子问题。不同点在于，适用于动态规划的问题，其子问题往往不是相互独立，倘若使用分治法，会进行大量的重复计算。比如斐波那契数列求解问题，当计算Fib(10)时，会需要用到Fib(9)和Fib(8)，而计算Fib(9)也需要用到Fib(8)，实际上Fib(8)只需要计算一次即可，倘若使用分治法会对其进行两次的计算。（然而实际上，计算斐波那契数列不会用到这种求解方式，可以使用迭代解决，或者直接使用通项公式求解）</p><p>动态规划通常可以按下面四个步骤设计：</p><ul><li>找出最优解的性质，并刻画其结构特征</li><li>递归定义最优解</li><li>以自底向上的方式计算出最优解</li><li>根据计算最优时得到的信息，构造最优解</li></ul><p>动态规划往往是利用空间换时间</p><h1 id="1-矩阵连乘"><a class="markdownIt-Anchor" href="#1-矩阵连乘"></a> 1. 矩阵连乘</h1><p>矩阵的乘法有结合律，不同的计算顺序所耗费的代价不同。比如：</p><table><thead><tr><th>矩阵1</th><th>矩阵2</th><th>矩阵3</th></tr></thead><tbody><tr><td>A<sub>10×100</sub></td><td>A<sub>100×5</sub></td><td>A<sub>5×50</sub></td></tr></tbody></table><ul><li><p>计算顺序1：（矩阵1×矩阵2）×矩阵3</p><p>所需要的乘法次数：10×5×100 + 10×50×5 = 7500次</p><p>所需要的加法次数：10×5×99 + 10×50×4 = 6950次</p></li><li><p>计算顺序2：矩阵1×（矩阵2×矩阵3）</p><p>所需要的乘法次数：100×50×5 + 10×50×100  = 750000次</p><p>所需要的加法次数：100×50×4 + 10×50×99 = 497000次</p></li></ul><p>这里不做矩阵相乘的O(n<sup>3</sup>)写法，相关代码可以参考<a href="/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90-%E5%88%86%E6%B2%BB%E6%B3%95/" title="算法设计与分析——分治法">算法设计与分析——分治法</a>Strassen矩阵乘法。</p><h1 id="2-最长公共子序列"><a class="markdownIt-Anchor" href="#2-最长公共子序列"></a> 2. 最长公共子序列</h1><h1 id="3-最大子段和"><a class="markdownIt-Anchor" href="#3-最大子段和"></a> 3. 最大子段和</h1><h1 id="4-凸多边形最优三角剖分"><a class="markdownIt-Anchor" href="#4-凸多边形最优三角剖分"></a> 4. 凸多边形最优三角剖分</h1><h1 id="5-多边形游戏"><a class="markdownIt-Anchor" href="#5-多边形游戏"></a> 5. 多边形游戏</h1><h1 id="6-图像压缩"><a class="markdownIt-Anchor" href="#6-图像压缩"></a> 6. 图像压缩</h1><h1 id="7-电路布线"><a class="markdownIt-Anchor" href="#7-电路布线"></a> 7. 电路布线</h1><h1 id="8-流水作业调度"><a class="markdownIt-Anchor" href="#8-流水作业调度"></a> 8. 流水作业调度</h1><h1 id="9-背包问题"><a class="markdownIt-Anchor" href="#9-背包问题"></a> 9. 背包问题</h1><h1 id="10-最优二叉搜索树"><a class="markdownIt-Anchor" href="#10-最优二叉搜索树"></a> 10. 最优二叉搜索树</h1>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 算法设计与分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> 动态规划 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KMP</title>
      <link href="KMP/"/>
      <url>KMP/</url>
      
        <content type="html"><![CDATA[<h1 id="1-kmp简介"><a class="markdownIt-Anchor" href="#1-kmp简介"></a> 1. KMP简介</h1><p>KMP算法是一种改进的字符串匹配算法，由D.E.Knuth，J.H.Morris和V.R.Pratt提出的，因此人们称它为克努特—莫里斯—普拉特操作（简称KMP算法）。KMP算法的核心是利用匹配失败后的信息，尽量减少模式串与主串的匹配次数以达到快速匹配的目的。具体实现就是通过一个next()函数实现，函数本身包含了模式串的局部匹配信息。KMP算法的时间复杂度O(m+n)</p><h1 id="2-kmp图解"><a class="markdownIt-Anchor" href="#2-kmp图解"></a> 2. KMP图解</h1><h2 id="21-通览编号从0开始"><a class="markdownIt-Anchor" href="#21-通览编号从0开始"></a> 2.1 通览(编号从0开始)</h2><h3 id="211-情况一"><a class="markdownIt-Anchor" href="#211-情况一"></a> 2.1.1 情况一</h3><img data-src="http://resource.silverbeats.cn/static/images/kmp_初始.png" alt="初始状态"><p>以上述主串和模式串为例子，可知，i指针指向主串，j指针指向模式串</p><p><strong>当主串i位置与模式串j位置字符一样，i，j向后移动一个位置</strong></p><h3 id="212-情况二"><a class="markdownIt-Anchor" href="#212-情况二"></a> 2.1.2 情况二</h3><img data-src="http://resource.silverbeats.cn/static/images/kmp_con1.png" alt="模式串编号5位置出现不匹配"><p>易知，当i=5，j=5时，主串与模式串发生不匹配，此时需要进行的操作就是KMP的精华所在。</p><ul><li>找到不匹配位置之前的字符串的最大公共前后缀。易知，最长公共前后缀是{A,B}，长度是2</li><li>进行如上图下半部分的操作。将字符串向后挪动，让前缀处于后缀的位置</li><li>易知，此时指针i是不需要任何变动。</li><li>挪动后，i，j所指向的位置继续比较。</li><li>字符串是不可能挪动的，实际上改变的是指针j，易知，挪动后指针j指向模式串编号为2的位置</li></ul><img data-src="http://resource.silverbeats.cn/static/images/kmp_con2.png" alt="模式串编号6位置出现不匹配"><p>上图，指针j经过调整后，从模式串编号2开始，继续和主串进行比较，当j指向编号6时发生不匹配，进行上述提到的步骤，经过调整得到下图情况三。</p><h3 id="213-情况三"><a class="markdownIt-Anchor" href="#213-情况三"></a> 2.1.3 情况三</h3><img data-src="http://resource.silverbeats.cn/static/images/kmp_con3.png" alt="需要匹配的模式串长度超出主串长度"><p><strong>每次移动指针j后，需要检查主串剩余长度是否≥模式串需要匹配的长度</strong></p><h3 id="214-综合"><a class="markdownIt-Anchor" href="#214-综合"></a> 2.1.4 综合</h3><p>根据上面提到的情况进行汇总，也就是代码实现的需要用到的步骤</p><ul><li>当主串i位置与模式串j位置字符一样，i，j向后移动一个位置</li><li>当出现不匹配时，需要寻找不匹配位置之前的串的最大公共前后缀长度，比如长度是n，并将j移动到编号为n的位置，这里需要结合next数组，详情见[Next数组](#3. Next数组)</li><li>移动指针j后，需要检查主串剩余长度是否≥模式串需要匹配的长度，不符合条件直接break，返回匹配失败</li><li>当j的位置超过了模式串的编号，说明匹配成功，返回模式串第一个字符在主串出现的位置</li></ul><h2 id="22-通览编号从1开始"><a class="markdownIt-Anchor" href="#22-通览编号从1开始"></a> 2.2 通览(编号从1开始)</h2><img data-src="http://resource.silverbeats.cn/static/images/kmp_b1_con2.png"><p>整个过程与上面标号从0开始的过程大体一致，只有一个区别就是：调整指针j的值，指的位置是<mark>不匹配位置之前的字符串的<strong>最大公共前后缀长度+1</strong></mark></p><h1 id="3-next数组"><a class="markdownIt-Anchor" href="#3-next数组"></a> 3. Next数组</h1><p>通过上一节内容可以知道，KMP算法核心是指向模式串的指针j的移动，该指针的如何移动实际上与主串是什么无关，只与模式串有关。只需要将模式串研究明白，则可以对任意主串进行匹配。</p><p>因为要匹配任意主串，故很容易知道，模式串的<strong>每个位置</strong>都有可能和主串出现不匹配。这时，当模式串每个位置出现不匹配时，此时的指针j应该调整到哪个位置，需要研究。</p><ul><li>模式串第一个位置不匹配，j应该重新指向模式串的哪个位置</li><li>模式串第二个位置不匹配，j应该重新指向模式串的哪个位置</li><li>……</li></ul><p>将j重新指向的位置整理记录下来，存储到数组中，就是Next数组，Next数组的下标代表着该模式串出现不匹配的位置，数组下标对应的值就是j重新指向的位置。</p><p>同时需要考虑另外一个问题，这个问题在上面的内容有所体现。就是模式串起始编号是0还是1。起始编号不同，Next数组不同，二者之间相差一个位置</p><blockquote><p>在进行KMP算法之前，是需要先获取模式串的Next数组，以便使用。</p></blockquote><h2 id="31-起始位置0"><a class="markdownIt-Anchor" href="#31-起始位置0"></a> 3.1 起始位置：0</h2><img data-src="http://resource.silverbeats.cn/static/images/kmp_next_s0.png" alt="模式串编号从0开始"><img data-src="http://resource.silverbeats.cn/static/images/kmp_next_s0des.png" alt="上next数组表一些情况举例说明"><p>上图提供的示例不全，但足以说明当某个位置出现不匹配时，指针j重新定位的位置为：不匹配位置之前字符串的最大公共前后缀长度所对应的编号</p><p>首先，为什么首位是-1，因为模式串首位不匹配需要挪动的是指向主串的i指针，是特殊情况，这样在获取next数组值的时候发现是-1，就知道需要挪动i指针，然而在实现时，只需要判断j时候等于0即可，并不需要访问next[0]时候等于-1。</p><h2 id="32-起始位置1"><a class="markdownIt-Anchor" href="#32-起始位置1"></a> 3.2 起始位置：1</h2><img data-src="http://resource.silverbeats.cn/static/images/kmp_next_s1.png" alt="模式串编号从1开始"><h1 id="4-nextval数组"><a class="markdownIt-Anchor" href="#4-nextval数组"></a> 4. NextVal数组</h1><h1 id="5-代码"><a class="markdownIt-Anchor" href="#5-代码"></a> 5. 代码</h1><h2 id="51-next"><a class="markdownIt-Anchor" href="#51-next"></a> 5.1 Next</h2><h3 id="511-模式串从0标号"><a class="markdownIt-Anchor" href="#511-模式串从0标号"></a> 5.1.1 模式串从0标号</h3><p>代码实现所使用到的next数组并不是[上面](#3.1 起始位置：0)提到的next数组。这里的next数组是每一位的最长公共前后缀的长度。比如next[2]=2，表示模式串前三个包括第三个字符，它们的最长公共前后缀长度是2。所以，倘若是模式串j位置出现不匹配，那么j位置之前的字符的最长公共前后缀长度是next[j-1]</p><p>关于下面<code>getNext</code>方法，可以理解为自己匹配自己</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取该模式串每个位置的最大公共前后缀长度</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] getNext(<span class="keyword">char</span>[] pattern) &#123;</span><br><span class="line">  <span class="comment">// 模式串长度</span></span><br><span class="line">  <span class="keyword">int</span> len = pattern.length;</span><br><span class="line">  <span class="keyword">int</span>[] next = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">  next[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// i代表最长前后缀长度</span></span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>, j;</span><br><span class="line">  <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; len; j++) &#123;</span><br><span class="line">    <span class="keyword">while</span>(pattern[i] != pattern[j] &amp;&amp; i &gt; <span class="number">0</span>)</span><br><span class="line">      i = next[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(pattern[i] == pattern[j])</span><br><span class="line">      next[j] = ++i;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      next[j] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 模式串匹配kmp算法,匹配成功返回匹配的位置,失败则返回-1</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">char</span>[] str, <span class="keyword">char</span>[] pattern)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 这里的next数组是每个位置的最长公共前后缀的长度</span></span><br><span class="line">  <span class="comment">// 比如next[2]表示0、1、2三个位置组成的字符串公共前后缀的最大长度</span></span><br><span class="line">  <span class="keyword">int</span>[] next = getNext(pattern);</span><br><span class="line">  <span class="comment">// 主串的长度mainLen,i指向主串比较的位置,j指向模式串比较的位置</span></span><br><span class="line">  <span class="keyword">int</span> mainLen = str.length, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(i &lt; mainLen) &#123;</span><br><span class="line">    <span class="comment">// 情况三: 主串不够长</span></span><br><span class="line">    <span class="keyword">if</span>(mainLen - i &lt; pattern.length - j) <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 情况一: 主串的字符与模式串字符相等</span></span><br><span class="line">    <span class="keyword">if</span>(str[i] == pattern[j]) &#123;</span><br><span class="line">      i++;</span><br><span class="line">      j++;</span><br><span class="line">      <span class="comment">// 当j指向的位置已经超过模式串长度时,说明匹配成功,则返回模式串在主串中匹配成功的位置</span></span><br><span class="line">      <span class="keyword">if</span>(j &gt;= pattern.length) <span class="keyword">return</span> i - pattern.length;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 情况二: 出现不匹配</span></span><br><span class="line">      <span class="comment">// 如果j是模式串0位置,特殊情况</span></span><br><span class="line">      <span class="keyword">if</span>(j == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 挪动主串指针i</span></span><br><span class="line">        i++;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 重定位到不匹配位置之前字符，最大公共前后缀长度</span></span><br><span class="line">        j = next[j - <span class="number">1</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 默认失败</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/kmp_s0_res.png" alt="运行结果"><p>同时可以发现，倘若要得到上面提到的那种next数组，只需要将里面所有的元素后移一个位置，然后首位添-1即可。上图中最后面的1会被舍弃。</p><h3 id="512-模式串从1标号"><a class="markdownIt-Anchor" href="#512-模式串从1标号"></a> 5.1.2 模式串从1标号</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取模式串的next数组</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] getNext(<span class="keyword">char</span>[] pattern) &#123;</span><br><span class="line">  <span class="comment">// 模式串长度</span></span><br><span class="line">  <span class="keyword">int</span> len = pattern.length;</span><br><span class="line">  <span class="keyword">int</span>[] next = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">  next[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// i代表最长前后缀长度</span></span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">1</span>, j;</span><br><span class="line">  <span class="keyword">for</span>(j = <span class="number">2</span>; j &lt; len; j++) &#123;</span><br><span class="line">    <span class="keyword">while</span>(pattern[i] != pattern[j] &amp;&amp; i &gt; <span class="number">1</span>)</span><br><span class="line">      i = next[i - <span class="number">1</span>]==<span class="number">0</span>?<span class="number">1</span>:next[i-<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(pattern[i] == pattern[j])</span><br><span class="line">      next[j] = i++;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      next[j] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 倘若写上了这一步,下面的kmp中的最后一个else只需要写j = next[j]即可</span></span><br><span class="line">  <span class="comment">// 倘若没有这一步,下面的kmp中的最后一个else需要写成j = next[j - 1] + 1</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> k = next.length - <span class="number">1</span>; k &gt; <span class="number">1</span>; k--) &#123;</span><br><span class="line">    next[k] = next[k-<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">char</span>[] str, <span class="keyword">char</span>[] pattern)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 获取该模式串的next数组</span></span><br><span class="line">  <span class="keyword">int</span>[] next = getNext2(pattern);</span><br><span class="line">  <span class="comment">// 主串的长度mainLen,i指向主串比较的位置,j指向模式串比较的位置</span></span><br><span class="line">  <span class="keyword">int</span> mainLen = str.length, i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i &lt; mainLen) &#123;</span><br><span class="line">    <span class="keyword">if</span>(mainLen - i &lt; pattern.length - j) <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 主串的字符与模式串字符相等</span></span><br><span class="line">    <span class="keyword">if</span>(str[i] == pattern[j]) &#123;</span><br><span class="line">      i++;</span><br><span class="line">      j++;</span><br><span class="line">      <span class="comment">// 当j指向的位置已经超过模式串长度时,说明匹配成功,则返回模式串在主串中匹配成功的位置</span></span><br><span class="line">      <span class="keyword">if</span>(j &gt;= pattern.length) <span class="keyword">return</span> i - pattern.length + <span class="number">1</span>; <span class="comment">// 这里有变化</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 如果模式串在j这个位置与主串i这个位置字符不相等,则需要通过next数组来重新定位指向模式串字符的j的值</span></span><br><span class="line">      <span class="keyword">if</span>(j == <span class="number">1</span>) &#123;</span><br><span class="line">        i++;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 这里有变化,倘若getNext有最后一个for循环</span></span><br><span class="line">        j = next[j];</span><br><span class="line">        <span class="comment">// 倘若getNext没有最后一个for循环需要下面这种写法</span></span><br><span class="line">        <span class="comment">// j = next[j - 1] + 1;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 默认失败</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/kmp_s1_res.png" alt="运行结果"><h2 id="52-nextval"><a class="markdownIt-Anchor" href="#52-nextval"></a> 5.2 NextVal</h2>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 数据结构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 串 </tag>
            
            <tag> KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法设计与分析——分治法</title>
      <link href="%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90-%E5%88%86%E6%B2%BB%E6%B3%95/"/>
      <url>%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%88%86%E6%9E%90-%E5%88%86%E6%B2%BB%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>分治法的基本思想是将一个规模为n的问题分解为k个规模较小的子问题，这些子问题互相独立且与原问题相同。递归的解决这些子问题，然后将各个子问题的解合并得到原问题。</p><h1 id="1-二分搜索法"><a class="markdownIt-Anchor" href="#1-二分搜索法"></a> 1. 二分搜索法</h1><p>最简单的想法是从头找到尾，进行遍历，时间复杂度为O(n)，而利用分治法思想，使用二分搜索法，可以将时间复杂度缩小为O(logn)，但是该方法有一个前提就是，这一个序列必须有序。</p><p><strong>下面代码假设序列是非递减序列</strong></p><ul><li>递归写法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> from, <span class="keyword">int</span> to, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 这说明没有数字了,说明没找到,返回-1</span></span><br><span class="line">  <span class="keyword">if</span>(to &lt; from) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="comment">// 得到from至to中间位置的数字的下标</span></span><br><span class="line">  <span class="keyword">int</span> midPos = (to + from) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="comment">// 如果找到了该数字,返回数组下标</span></span><br><span class="line">  <span class="keyword">if</span>(arr[midPos] == target) &#123;</span><br><span class="line">    <span class="keyword">return</span> midPos;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(arr[midPos] &gt; target) &#123;</span><br><span class="line">    <span class="comment">// 如果中间的数字比目标值大,说明目标值值在中间值的左边</span></span><br><span class="line">    <span class="keyword">return</span> binarySearch(arr, from, midPos - <span class="number">1</span>, target);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果中间的数字比目标值大,说明目标值值在中间值的右边</span></span><br><span class="line">    <span class="keyword">return</span> binarySearch(arr, midPos + <span class="number">1</span>, to, target);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>非递归写法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">binarySearch2</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 两个指针指向target存在区域的左右边界,圈定范围</span></span><br><span class="line">  <span class="keyword">int</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(left &lt;= right) &#123;</span><br><span class="line">    <span class="comment">// 得到该范围的中间位置</span></span><br><span class="line">    <span class="keyword">int</span> midPos = (right + left) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 说明找到了</span></span><br><span class="line">    <span class="keyword">if</span>(arr[midPos] == target) <span class="keyword">return</span> midPos;</span><br><span class="line">    <span class="comment">// 如果中间值大,说明目标值在中间值左边,右边界right指针挪到midPos的前一个</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(arr[midPos] &gt; target) right = midPos - <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 如果中间值大,说明目标值在中间值左边,右边界left指针挪到midPos的后一个</span></span><br><span class="line">    <span class="keyword">else</span> left = midPos + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 找不到返回-1</span></span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-大整数乘法"><a class="markdownIt-Anchor" href="#2-大整数乘法"></a> 2. 大整数乘法</h1><p>对于乘法，直接使用乘法的运算符会很方便，但是仅限于参加运算的整数能在计算机硬件对整数的表示范围内直接处理时才是合理的。当需要处理很大的整数时，无法在计算机硬件能直接表示的整数范围内进行处理，若用浮点数表示，只能得到近似值，计算结果中的有效位数也会受到限制。</p><p>同时，当XY分3块，4块乃至更多，只会越来越慢。当分两块时，初步版需要4次，改进版需要3次相乘；而分成3块，其初步版就需要9次，想要得到比分成2块改进版的3次更少的乘法次数是不可能的，更何况是16次乘法的分4块初步版。</p><p>同时下图所示的过程有前提条件：</p><ul><li>X,Y都是n位，且n是2的整数次幂，只有这样才能保证每次划分A,B,C,D四个部分位数保持一致</li><li>（A-B），(D-C)这个两个数也需要满足上面这一条要求。因为这两个数相乘也是需要递归使用同一个函数</li></ul><p>然而前提条件很多，实际上在使用时，上面两个条件都很难达到。当落地时，是实现初步版，计算4次乘法。</p><p><img data-src="http://resource.silverbeats.cn/static/images/%E5%A4%A7%E6%95%B4%E6%95%B0%E4%B9%98%E6%B3%95.png" alt="大整数乘法逻辑" /></p><p>这里进行说明，为什么X可以那样表示。</p><p>比如一个十进制数1234，一共4位，按照上面的样子进行划分成左右AB两部分，则1234 = 12 * 10<sup>2</sup> + 34，这里的10其实是进制</p><p>同理，案例中，XY都是二进制，如X = 1101，X = 11 * 2<sup>2</sup> + 01，1101的十进制是13，11的十进制是3，01的十进制是1，X = 3 * 4 + 1 = 13</p><h2 id="21-on2写法"><a class="markdownIt-Anchor" href="#21-on2写法"></a> 2.1 O(n<sup>2</sup>)写法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为数字很大,无法用某个整数数据类型表示,需要转换成整型数组,方便处理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] NumToArr(String num) &#123;</span><br><span class="line">  num = fliter(num);</span><br><span class="line">  <span class="keyword">char</span>[] temp = num.toCharArray();</span><br><span class="line">  <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[temp.length];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; temp.length; i++) &#123;</span><br><span class="line">    arr[i] = Integer.parseInt(temp[i] + <span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 倘若传进来的字符串num中有0开头,比如0123,,或者00123,需要将0去掉</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">fliter</span><span class="params">(String num)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> pos0 = num.indexOf(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span>(pos0 != <span class="number">0</span>) <span class="keyword">return</span> num;</span><br><span class="line">  StringBuilder sb = <span class="keyword">new</span> StringBuilder(num);</span><br><span class="line">  <span class="keyword">while</span>(pos0 == <span class="number">0</span>) &#123;</span><br><span class="line">    sb.deleteCharAt(pos0);</span><br><span class="line">    pos0 = sb.indexOf(<span class="string">&#x27;0&#x27;</span> + <span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// O(n2)的大整数乘法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">LargeIntegerMultiplication</span><span class="params">(<span class="keyword">int</span>[] num1, <span class="keyword">int</span>[] num2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len1 = num1.length;</span><br><span class="line">  <span class="keyword">int</span> len2 = num2.length;</span><br><span class="line">  <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[len1 * len2];</span><br><span class="line">  <span class="keyword">int</span> p = res.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = len1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = len2 - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">      res[p--] += num2[j] * num1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    p++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 处理进制</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> k = res.length - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--) &#123;</span><br><span class="line">    <span class="keyword">if</span>(res[k] &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">      res[k - <span class="number">1</span>] = res[k] / <span class="number">10</span>;</span><br><span class="line">      res[k] %= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 从后向前充填res数组，可能没有填满，导致前几位有0</span></span><br><span class="line">  StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">  <span class="comment">// 从头向后遍历当遇到第一次非0数字后,flag为true</span></span><br><span class="line">  <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; res.length; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (res[k] != <span class="number">0</span>) flag = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(flag) sb.append(res[k]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="22-分治法版本的on2"><a class="markdownIt-Anchor" href="#22-分治法版本的on2"></a> 2.2 分治法版本的O(n<sup>2</sup>)</h2><h3 id="221-主体"><a class="markdownIt-Anchor" href="#221-主体"></a> 2.2.1 主体</h3><p>这里使用字符串，方便截取获得ABCD</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 大整数乘法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">largeLongMultiply</span><span class="params">(String num1, String num2)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 存储num1乘num2的结果的数组</span></span><br><span class="line">  <span class="keyword">int</span>[] res;</span><br><span class="line">  <span class="comment">// 只要有一个字符串数字长度为1,那么就可以直接相乘了</span></span><br><span class="line">  <span class="keyword">if</span> (num1.length() == <span class="number">1</span> || num2.length() == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// 相乘</span></span><br><span class="line">    res = mult(num1, num2);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 因为num1和num2长度不一定相同,假设num1长度为a,num2长度为b,同样分成两部分</span></span><br><span class="line">    <span class="comment">// num1 = A*10^(a/2) + B</span></span><br><span class="line">    <span class="comment">// num2 = C*10^(b/2) + D</span></span><br><span class="line">    <span class="comment">// num1*num2 = AC*10^(a/2+b/2) + BD + AD10^(a/2) + BC*10^(b/2)</span></span><br><span class="line">    <span class="comment">// 开始截取字符串,得到ABCD</span></span><br><span class="line">    <span class="keyword">int</span> halfNum1 = num1.length() &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> halfNum2 = num2.length() &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    String A = num1.substring(<span class="number">0</span>, halfNum1),</span><br><span class="line">    B = num1.substring(halfNum1),</span><br><span class="line">    C = num2.substring(<span class="number">0</span>, halfNum2),</span><br><span class="line">    D = num2.substring(halfNum2);</span><br><span class="line">    <span class="comment">// 开始相乘</span></span><br><span class="line">    String AC = largeLongMultiply(A, C),</span><br><span class="line">    BD = largeLongMultiply(B, D),</span><br><span class="line">    AD = largeLongMultiply(A, D),</span><br><span class="line">    BC = largeLongMultiply(B, C);</span><br><span class="line">    <span class="comment">// 位移,相加并得到最终结果</span></span><br><span class="line">    res = arrAddArr(</span><br><span class="line">      strNumToArr(BD),</span><br><span class="line">      arrAddArr(</span><br><span class="line">        arrAddArr(</span><br><span class="line">          move(strNumToArr(AC), halfNum1 + halfNum2),</span><br><span class="line">          move(strNumToArr(AD), halfNum1)</span><br><span class="line">        ),</span><br><span class="line">        move(strNumToArr(BC), halfNum2)</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 处理进制</span></span><br><span class="line">  decimalism(res);</span><br><span class="line">  <span class="comment">// 处理首位0,并转成字符串返回</span></span><br><span class="line">  <span class="keyword">return</span> arrToStr(filterZero(res));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/字符串大整数乘法结果.png" alt="运行结果"><h3 id="222-主体之外的函数"><a class="markdownIt-Anchor" href="#222-主体之外的函数"></a> 2.2.2 主体之外的函数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只有当str1或者str2的length为1时才会执行这里</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] mult(String str1, String str2) &#123;</span><br><span class="line">  <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[str1.length()];</span><br><span class="line">  <span class="keyword">int</span>[] b = <span class="keyword">new</span> <span class="keyword">int</span>[str2.length()];</span><br><span class="line">  <span class="comment">// 将两个字符串变为数组,并且每个元素都是int类型</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++)</span><br><span class="line">    a[i] = (<span class="keyword">int</span>) str1.charAt(i) - <span class="number">48</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; b.length; i++)</span><br><span class="line">    b[i] = (<span class="keyword">int</span>) str2.charAt(i) - <span class="number">48</span>;</span><br><span class="line">  <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[Math.max(a.length, b.length) + <span class="number">1</span>];</span><br><span class="line">  <span class="comment">// 二者进行相乘</span></span><br><span class="line">  <span class="keyword">if</span> (a.length == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; b.length; i++)</span><br><span class="line">      res[i] = b[i] * a[<span class="number">0</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++)</span><br><span class="line">      res[i] = a[i] * b[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 返回乘积结果</span></span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 字符串数字变数组</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] strNumToArr(String str) &#123;</span><br><span class="line">  <span class="keyword">int</span> len = str.length();</span><br><span class="line">  <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    arr[i] = (<span class="keyword">int</span>) str.charAt(i) - <span class="number">48</span>;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 数组变字符串</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">arrToStr</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    sb.append(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// arr数组所代表的数字扩大n位</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] move(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> n) &#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[len + n];</span><br><span class="line">  System.arraycopy(arr, <span class="number">0</span>, res, <span class="number">0</span>, len);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 两个数组相加</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] arrAddArr(<span class="keyword">int</span>[] arr1, <span class="keyword">int</span>[] arr2) &#123;</span><br><span class="line">  <span class="keyword">int</span> len1 = arr1.length, len2 = arr2.length;<span class="comment">//123,12</span></span><br><span class="line">  <span class="comment">// 这里还需要长度＋1是因为：900 + 900 = 1800类似这种情况</span></span><br><span class="line">  <span class="comment">// 另外两个相加的数组的长度不一定一样</span></span><br><span class="line">  <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[Math.max(len1, len2) + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">int</span> p = res.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> dist = len1 - len2;</span><br><span class="line">  <span class="keyword">if</span> (dist &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// arr1短</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len1 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      res[p--] = arr1[i] + arr2[i - dist];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = -dist - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      res[p--] = arr2[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dist &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// arr2短</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len2 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      res[p--] = arr1[i + dist] + arr2[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = dist - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      res[p--] = arr1[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = arr1.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      res[p--] = arr1[i] + arr2[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 处理进制</span></span><br><span class="line">  decimalism(res);</span><br><span class="line">  <span class="comment">// 再次考虑,当res[0]为0的情况</span></span><br><span class="line">  <span class="keyword">return</span> filterZero(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 进制处理</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">decimalism</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 处理进制</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> k = arr.length - <span class="number">1</span>; k &gt; <span class="number">0</span>; k--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[k] &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">      arr[k - <span class="number">1</span>] += arr[k] / <span class="number">10</span>;</span><br><span class="line">      arr[k] %= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 处理数组arr首位为0的情况</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] filterZero(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">  <span class="keyword">if</span> (arr[<span class="number">0</span>] != <span class="number">0</span>) <span class="keyword">return</span> arr;</span><br><span class="line">  <span class="comment">// 从头遍历arr,当出现第一个不为0的数字后,会变成true</span></span><br><span class="line">  <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">  <span class="comment">// 用来统计非0数字前面,0的个数</span></span><br><span class="line">  <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length &amp;&amp; !flag; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[i] != <span class="number">0</span>) flag = <span class="keyword">true</span>;</span><br><span class="line">    <span class="comment">// 倘若还没有遇到第一个不为0的数字,计数+1</span></span><br><span class="line">    <span class="keyword">if</span> (!flag) k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 比如[0,0,1,2,3],经过统计k=2,那么最终的finalRes长度应该是3 = arr.length - k</span></span><br><span class="line">  <span class="keyword">int</span>[] finalRes = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length - k];</span><br><span class="line">  <span class="comment">// 开始拷贝的位置下标应该是k</span></span><br><span class="line">  System.arraycopy(arr, k, finalRes, <span class="number">0</span>, finalRes.length);</span><br><span class="line">  <span class="keyword">return</span> finalRes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-strassen矩阵乘法"><a class="markdownIt-Anchor" href="#3-strassen矩阵乘法"></a> 3. Strassen矩阵乘法</h1><p>矩阵乘法，线性代数常见，假设两个矩阵同型AB，都是n×n的矩阵，C = AB，则在计算矩阵C时，C中每个元素都需要进行n次乘法和n-1次加法，最终求出C，n<sup>2</sup>个元素需要的计算时间复杂度是O(n<sup>3</sup>)</p><h2 id="31-on3写法"><a class="markdownIt-Anchor" href="#31-on3写法"></a> 3.1 O(n<sup>3</sup>)写法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 矩阵m1,a行b列;矩阵m2,c行d列</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[][] matrixMultiply(<span class="keyword">int</span>[][] m1, <span class="keyword">int</span>[][] m2) &#123;</span><br><span class="line">  <span class="comment">// m1的行数,m1的列数</span></span><br><span class="line">  <span class="keyword">int</span> m1Col = m1.length, m1Row = m1[<span class="number">0</span>].length;</span><br><span class="line">  <span class="comment">// m2的行数,m2的列数</span></span><br><span class="line">  <span class="keyword">int</span> m2Col = m1.length, m2Row = m2[<span class="number">0</span>].length;</span><br><span class="line">  <span class="comment">// 检查矩阵相乘的条件</span></span><br><span class="line">  <span class="keyword">if</span> (m1Row != m2Col) <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;矩阵无法相乘&quot;</span>);</span><br><span class="line">  <span class="comment">// 新建一个存储结果的矩阵</span></span><br><span class="line">  <span class="keyword">int</span>[][] res = <span class="keyword">new</span> <span class="keyword">int</span>[m1Col][m2Row];</span><br><span class="line">  <span class="comment">// 遍历m1的第i行</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m1Col; i++) &#123;</span><br><span class="line">    <span class="comment">// 遍历m2的第j列</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m2Row; j++) &#123;</span><br><span class="line">      <span class="comment">// 遍历m2的第k行</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; m2Col; k++) &#123;</span><br><span class="line">        res[i][j] += m1[i][k] * m2[k][j];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="32-分治思想"><a class="markdownIt-Anchor" href="#32-分治思想"></a> 3.2 分治思想</h2><p>假设条件：</p><ul><li>两个矩阵都是n×n</li><li>n都是2的幂</li></ul><img data-src="http://resource.silverbeats.cn/static/images/Strassen.png" alt="Strassen"><h1 id="4-棋盘覆盖"><a class="markdownIt-Anchor" href="#4-棋盘覆盖"></a> 4. 棋盘覆盖</h1><h1 id="5-合并排序"><a class="markdownIt-Anchor" href="#5-合并排序"></a> 5. 合并排序</h1><p>其实就是归并排序，相关代码可以查看<a href="/%E6%8E%92%E5%BA%8F/" title="排序">排序</a></p><h1 id="6-快速排序"><a class="markdownIt-Anchor" href="#6-快速排序"></a> 6. 快速排序</h1><p>相关代码可以查看<a href="/%E6%8E%92%E5%BA%8F/" title="排序">排序</a></p><p>快速排序的运行时间与每次划分是否对称有关，划分的最坏情况就是一边1个元素，另一边n-1的元素，当每次都划分对称的时候，时间复杂度是O(nlogn)，当每次划分都最坏的时候，时间复杂度是O(n<sup>2</sup>)，在<a href="/%E6%8E%92%E5%BA%8F/" title="排序">排序</a>提到，对于快速排序来说，越有序越慢，因为越有序，每次划分出现最坏情况的可能性就越大。</p><p>为了尽可能每次划分都较为对称，可以采用随机选择策略的快速排序算法。快速排序对于基准的选择都是待排序序列的第一个元素，随机选择意思就是说，在进行快速排序之前，先从序列中随机挑一个元素与序列首位进行位置交换，这样快排时的基准就是随机的了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现随机选择基准</span></span><br><span class="line"><span class="comment">// (int)(Math.random()*(high - low + 1))范围：[0,high - low + 1)</span></span><br><span class="line"><span class="comment">// (int)(Math.random()*(high - low + 1)) + low范围：[low,high + 1)，即[low, high]</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">RandomizedPartition</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// i是从low-high随机挑选出来的下标</span></span><br><span class="line">  <span class="keyword">int</span> i = (<span class="keyword">int</span>)(Math.random()*(high - low + <span class="number">1</span>)) + low;</span><br><span class="line">  <span class="comment">// 将i位置的元素与待排序范围的首位进行交换</span></span><br><span class="line">  <span class="keyword">int</span> temp = arr[low];</span><br><span class="line">  arr[low] = arr[i];</span><br><span class="line">  arr[i] = temp;</span><br><span class="line">  <span class="keyword">return</span> QSort_Partition(arr, low, high);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 快速排序</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">QSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (low &lt; high) &#123;</span><br><span class="line">    <span class="keyword">int</span> piovtpos = RandomizedPartition(arr, low, high);</span><br><span class="line">    <span class="comment">// 排左边</span></span><br><span class="line">    QSort(arr, low, piovtpos - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 排右边</span></span><br><span class="line">    QSort(arr, piovtpos + <span class="number">1</span>, high);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 一趟快速排序</span></span><br><span class="line"><span class="comment">// 参数1：数组,参数2：数组的起始位置,参数3：数组的终了位置,闭区间</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">QSort_Partition</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 指定基准</span></span><br><span class="line">  <span class="keyword">int</span> base = arr[left];</span><br><span class="line">  <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= base) right--;</span><br><span class="line">    <span class="keyword">if</span> (left &lt; right) arr[left] = arr[right];</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right &amp;&amp; arr[left] &lt; base) left++;</span><br><span class="line">    <span class="keyword">if</span> (left &lt; right) arr[right] = arr[left];</span><br><span class="line">  &#125;</span><br><span class="line">  arr[left] = base;</span><br><span class="line">  <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="7-线性时间选择"><a class="markdownIt-Anchor" href="#7-线性时间选择"></a> 7. 线性时间选择</h1><p>给定一串数字，从中选出第k小，时间复杂度要求是O(n)，即线性时间选择。</p><h2 id="71-利用堆排序获得第k小"><a class="markdownIt-Anchor" href="#71-利用堆排序获得第k小"></a> 7.1 利用堆排序获得第k小</h2><p>易知，倘若要知道第k小的关键字，那么只需要利用小根堆，进行k次堆调整，即可得到第k小的关键字。</p><p>其中adjustHeap函数的代码可见<a href="/%E6%8E%92%E5%BA%8F/" title="排序">排序</a>，其中adjustHeap函数是调整成大根堆，只需要将循环中两个if判断条件中的小于号改成大于号，即可实现调整为小根堆的功能</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">heapSortFindK</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 存储arr,目的是堆排序过程中不改变原数组</span></span><br><span class="line">  <span class="keyword">int</span>[] temp = arr.clone();</span><br><span class="line">  <span class="keyword">int</span> len = temp.length;</span><br><span class="line">  <span class="comment">// 首先构建小根堆</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> pos = len / <span class="number">2</span> - <span class="number">1</span>; pos &gt;= <span class="number">0</span>; --pos) &#123;</span><br><span class="line">    <span class="comment">//从第一个非叶子结点从下至上，从右至左调整结构</span></span><br><span class="line">    adjustHeap(temp, pos, len);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 经过上一步可以得到小根堆,现在开始排序</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = len - <span class="number">1</span>; j &gt;= len - k; --j) &#123;</span><br><span class="line">    <span class="comment">//将堆顶元素与末尾元素进行交换</span></span><br><span class="line">    swap(temp, <span class="number">0</span>, j);</span><br><span class="line">    <span class="comment">//重新对堆进行调整</span></span><br><span class="line">    adjustHeap(temp, <span class="number">0</span>, j);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> temp[len - k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="72-利用快速排序获得第k小"><a class="markdownIt-Anchor" href="#72-利用快速排序获得第k小"></a> 7.2 利用快速排序获得第k小</h2><p>每一次快排都会选则一个基准，将其排到它的最终位置，而第k小在排好序的序列中排在第k位。所以，可以通过比较每次快排后基准的最终位置与k，来获取第k小</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">QSortFindK</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> k, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 首先,一趟快速排序,确定一个关键字的最终位置</span></span><br><span class="line">  <span class="keyword">int</span> piovtpos = QSort_Partition(arr, start, end);</span><br><span class="line">  <span class="comment">// 易知，为了使快速排序的效率变高，可以利用上述随机策略法。</span></span><br><span class="line">  <span class="comment">// int piovtpos = RandomizedPartition(arr, start, end);</span></span><br><span class="line">  <span class="keyword">if</span>(piovtpos + <span class="number">1</span> == k)</span><br><span class="line">    <span class="comment">// 倘若该数字正好是第k小</span></span><br><span class="line">    <span class="keyword">return</span> arr[piovtpos];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(piovtpos + <span class="number">1</span> &gt; k) &#123;</span><br><span class="line">    <span class="comment">// 说明目标在该数字的左边</span></span><br><span class="line">    <span class="keyword">return</span> QSortFindK(arr, k, start, piovtpos - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> QSortFindK(arr, k, piovtpos + <span class="number">1</span>, end);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="8-最接近点对问题"><a class="markdownIt-Anchor" href="#8-最接近点对问题"></a> 8. 最接近点对问题</h1><p>平面中有n个点，求出哪两个点之间的距离是最短的。很容易想到O(n<sup>2</sup>)的写法，倘若利用分治法，可以将时间复杂度降低为O(nlog<sub>2</sub>n)</p><h1 id="9-循环赛日程表"><a class="markdownIt-Anchor" href="#9-循环赛日程表"></a> 9. 循环赛日程表</h1>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 算法设计与分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> 分治法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最短路径</title>
      <link href="%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/"/>
      <url>%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<img data-src="http://resource.silverbeats.cn/static/images/bg_07.jpg"><h1 id="1-迪杰斯特拉dijkstra算法详解"><a class="markdownIt-Anchor" href="#1-迪杰斯特拉dijkstra算法详解"></a> 1. 迪杰斯特拉Dijkstra算法详解</h1><h2 id="11-完整代码"><a class="markdownIt-Anchor" href="#11-完整代码"></a> 1.1 完整代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span>[][] graph, <span class="keyword">int</span> start)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 当起点无法达到该点时,路径长度是无穷大,这里用整型最大值代替</span></span><br><span class="line">  <span class="keyword">int</span> MAXDIST = Integer.MAX_VALUE;</span><br><span class="line">  <span class="keyword">int</span> vertexNum = graph.length;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 1. Dijkstra算法需要三个辅助数组</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">  <span class="keyword">boolean</span>[] isVisited = <span class="keyword">new</span> <span class="keyword">boolean</span>[vertexNum];</span><br><span class="line">  <span class="keyword">int</span>[] path = <span class="keyword">new</span> <span class="keyword">int</span>[vertexNum];</span><br><span class="line">  <span class="keyword">int</span>[] dist = <span class="keyword">new</span> <span class="keyword">int</span>[vertexNum];</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 2. 初始化</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum; i++) &#123;</span><br><span class="line">    dist[i] = graph[start][i];</span><br><span class="line">    <span class="keyword">if</span> (graph[start][i] &lt; MAXDIST) &#123;</span><br><span class="line">      path[i] = start;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      path[i] = -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// start起点默认已经被访问</span></span><br><span class="line">  isVisited[start] = <span class="keyword">true</span>;</span><br><span class="line">  <span class="comment">// start没有前驱结点,因为它是开始的位置</span></span><br><span class="line">  path[start] = -<span class="number">1</span>;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 3. 迪杰斯特拉算法核心</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// 存储最短路径</span></span><br><span class="line">    <span class="keyword">int</span> minPath = MAXDIST;</span><br><span class="line">    <span class="comment">// 存储距离最小的点的数组下标</span></span><br><span class="line">    <span class="comment">// 倘若这里minIndex不赋初始值,在后面isVisited[minIndex] = true会报错</span></span><br><span class="line">    <span class="comment">// 因为后面的循环找最小值可能找不到</span></span><br><span class="line">    <span class="keyword">int</span> minIndex = start;</span><br><span class="line">    <span class="comment">// 这个循环目的是:从未访问的节点中找到路径最短的那个</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) &#123;</span><br><span class="line">      <span class="comment">// 倘若这个节点没有访问,并且该点小于最短路径</span></span><br><span class="line">      <span class="keyword">if</span> (!isVisited[j] &amp;&amp; dist[j] &lt; minPath) &#123;</span><br><span class="line">        minPath = dist[j];</span><br><span class="line">        minIndex = j;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (minIndex != start) isVisited[minIndex] = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!isVisited[j] &amp;&amp; graph[minIndex][j] != MAXDIST </span><br><span class="line">          &amp;&amp; dist[minIndex] + graph[minIndex][j] &lt; dist[j] </span><br><span class="line">          &amp;&amp; minIndex != start) &#123;</span><br><span class="line">        dist[j] = dist[minIndex] + graph[minIndex][j];</span><br><span class="line">        path[j] = minIndex;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-分段解读"><a class="markdownIt-Anchor" href="#12-分段解读"></a> 1.2 分段解读</h2><h3 id="121-完整过程图示"><a class="markdownIt-Anchor" href="#121-完整过程图示"></a> 1.2.1  完整过程图示</h3><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_完整示例.png" alt="完整过程图示"><h3 id="122-辅助数组说明"><a class="markdownIt-Anchor" href="#122-辅助数组说明"></a> 1.2.2 辅助数组说明</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用来记录每个节点是否被访问</span></span><br><span class="line"><span class="keyword">boolean</span>[] isVisited = <span class="keyword">new</span> <span class="keyword">boolean</span>[vertexNum];</span><br><span class="line"><span class="comment">// 用来存储到达某个点最短路径的前一个节点下标</span></span><br><span class="line"><span class="comment">// 比如上图第1次循环,到达顶点4的最短路径是0-2-4,那么path[4]存放下标2</span></span><br><span class="line"><span class="comment">// 这个数组的每个值会不断变动</span></span><br><span class="line"><span class="keyword">int</span>[] path = <span class="keyword">new</span> <span class="keyword">int</span>[vertexNum];</span><br><span class="line"><span class="comment">// 存放到某个顶点的最短路径长度</span></span><br><span class="line"><span class="comment">// 比如顶点4,dist[4]从8,最后修改成7,这个数组的每个值会不断变动</span></span><br><span class="line"><span class="keyword">int</span>[] dist = <span class="keyword">new</span> <span class="keyword">int</span>[vertexNum];</span><br></pre></td></tr></table></figure><h3 id="123-初始化说明"><a class="markdownIt-Anchor" href="#123-初始化说明"></a> 1.2.3 初始化说明</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum; i++) &#123;</span><br><span class="line">  dist[i] = graph[start][i];</span><br><span class="line">  <span class="comment">// 这一步其实可以不用,声明boolean数组时默认就是false</span></span><br><span class="line">  <span class="comment">// isVisited[i] = false;</span></span><br><span class="line">  <span class="comment">// start点到i有路径,这里面包含了start自己到自己</span></span><br><span class="line">  <span class="comment">// path[start]=start,这是不对的,start没有前驱节点,应该存-1,循环结束之后会做处理</span></span><br><span class="line">  <span class="keyword">if</span> (graph[start][i] &lt; MAXDIST) &#123;</span><br><span class="line">    path[i] = start;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 没有前驱节点的意思,当前以start为起点,到不了i这个点</span></span><br><span class="line">    path[i] = -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// start起点默认已经被访问</span></span><br><span class="line">isVisited[start] = <span class="keyword">true</span>;</span><br><span class="line"><span class="comment">// start没有前驱结点,因为它是开始的位置</span></span><br><span class="line">path[start] = -<span class="number">1</span>;</span><br></pre></td></tr></table></figure><h3 id="124-算法核心说明"><a class="markdownIt-Anchor" href="#124-算法核心说明"></a> 1.2.4 算法核心说明</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum; i++) &#123;</span><br><span class="line">  <span class="comment">// 存储最短路径</span></span><br><span class="line">  <span class="keyword">int</span> minPath = MAXDIST;</span><br><span class="line">  <span class="comment">// 存储距离最小的点的数组下标</span></span><br><span class="line">  <span class="comment">// 倘若这里minIndex不赋初始值,在后面isVisited[minIndex] = true会报错</span></span><br><span class="line">  <span class="comment">// 因为后面的循环找最小值可能找不到</span></span><br><span class="line">  <span class="keyword">int</span> minIndex = start;</span><br><span class="line">  <span class="comment">// 这个循环目的是:从未访问的节点中找到路径最短的那个</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum - <span class="number">1</span>; j++) &#123;</span><br><span class="line">    <span class="comment">// 倘若这个节点没有访问,并且该点小于最短路径</span></span><br><span class="line">    <span class="keyword">if</span> (!isVisited[j] &amp;&amp; dist[j] &lt; minPath) &#123;</span><br><span class="line">      minPath = dist[j];</span><br><span class="line">      minIndex = j;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (minIndex != start) isVisited[minIndex] = <span class="keyword">true</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isVisited[j] &amp;&amp; graph[minIndex][j] != MAXDIST </span><br><span class="line">        &amp;&amp; dist[minIndex] + graph[minIndex][j] &lt; dist[j] </span><br><span class="line">        &amp;&amp; minIndex != start) &#123;</span><br><span class="line">      dist[j] = dist[minIndex] + graph[minIndex][j];</span><br><span class="line">      path[j] = minIndex;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>内层循环第一个for比较简单，目的是找到一个点，该点满足：①未被访问，②有路径能访问，③到达改点路径值最小</p><p>内层循环第二个详解见下图：</p><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_for_0.png"><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_for_01.png"><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_for_02.png"><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_for_03.png"><blockquote><p>❥(^_-)Tip：</p><p>当你使用某个数据类型的最大值作为无穷大，表示无该路径时，需要注意dist[minIndex] + graph[minIndex][j] &lt; dist[j]，倘若graph[minIndex][j]是无穷大，再加上一个数字后，会超出该类型的表示范围，变成一个负数，从而达成这个判断条件，执行if代码块中语句。这并不是我们想要的。所以需要在if中需要添加graph[minIndex][j] != MAXDIST这句话，避免上述情况发生</p></blockquote><h2 id="13-思考"><a class="markdownIt-Anchor" href="#13-思考"></a> 1.3 思考</h2><p>首先，迪杰斯特拉算法能解决单源并且没有负权值边的最短路径问题，那么倘若出现负权值边，该算法不能求解出最短路径的原因是什么</p><h3 id="131-尝试一下"><a class="markdownIt-Anchor" href="#131-尝试一下"></a> 1.3.1 尝试一下</h3><p><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_try_0.png" alt="" /></p><p>当把1-&gt;2的权值改为-3后，继续走一遍之前的代码，就可以发现问题。</p><p>当i = 1时，即第二次循环，此时的minIndex为1，当j = 2时，根据if条件，因为isVisited[2]是之前访问过的点，所以不会执行if语句块中的代码，即便<code>dist[minIndex] + graph[minIndex][j] &lt; dist[j]，5 + (-3) &lt; 3</code></p><p>那么倘若if中没有<code>!isVisited[j]</code>这个判断是否就可以了呢？</p><p><img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_try_tempRes.png" alt="删除isVisited[j]之后执行的结果" /></p><p>根据上图，可以看到path数组是没有问题的，但是问题出在了dist[4]上。dist[4]应该为6，但却是7，这里是因为什么原因导致的？</p><p>手动模拟一遍过程后不难发现，i=0的第一次循环修改了dist[4]和path[4]；在i=1的第二次循环，到达节点2的最短路径发生变化，但是没有任何的机会去修改以2为前驱的点的dist数组。</p><p>所以在第二个for循环中再添加一个循环，倘若某个点x的最短路径发生变化，去找以x为前驱的其他点y，看看y这个点的最短路径有没有因为x的变化而缩短。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (graph[minIndex][j] != MAXDIST &amp;&amp; dist[minIndex] + graph[minIndex][j] &lt; dist[j] &amp;&amp; minIndex != start) &#123;</span><br><span class="line">    dist[j] = dist[minIndex] + graph[minIndex][j];</span><br><span class="line">    path[j] = minIndex;</span><br><span class="line">    <span class="comment">// 在遍历一遍path数组</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; vertexNum; k++) &#123;</span><br><span class="line">      <span class="comment">// 如果path数组的某个点的前驱节点正好是修改长度的点的话</span></span><br><span class="line">      <span class="keyword">if</span>(path[k] == j &amp;&amp; dist[k] &gt; dist[j] + graph[j][k]) &#123;</span><br><span class="line">        dist[k] = dist[j] + graph[j][k];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之后的结果就没有问题了：<img data-src="http://resource.silverbeats.cn/static/images/Dijkstra_try_res.png" alt="" /></p><h1 id="2-弗洛伊德floyd算法详解"><a class="markdownIt-Anchor" href="#2-弗洛伊德floyd算法详解"></a> 2. 弗洛伊德Floyd算法详解</h1><p>其实倘若涉及到负权值，会选择用Floyd算法，而且，更为强大的是，Floyd能够求出各个顶点到其他点的最短距离。</p><p>我不能呼吸了……= =</p><h2 id="21-完整代码"><a class="markdownIt-Anchor" href="#21-完整代码"></a> 2.1 完整代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Floyd</span><span class="params">(<span class="keyword">int</span>[][] graph)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> vertexNum = graph.length;</span><br><span class="line">  <span class="comment">// path数组,用来存储路径</span></span><br><span class="line">  <span class="keyword">int</span>[][] path = <span class="keyword">new</span> <span class="keyword">int</span>[vertexNum][vertexNum];</span><br><span class="line">  <span class="comment">// 初始化</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) path[i][j] = -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vertexNum; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vertexNum; j++) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; vertexNum; k++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(graph[j][i] == Integer.MAX_VALUE || graph[i][k] == Integer.MAX_VALUE) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> temp = graph[j][i] + graph[i][k];</span><br><span class="line">        <span class="keyword">if</span>(graph[j][k] &gt; temp) graph[j][k] = temp;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/Floyd.png" alt="佛洛依德算法结果"><p>举例：顶点0到4的最短路径</p><p>graph(0,4)的数字是6，说明最短路径长度是6，那么该怎么走呢。这是需要看path数组</p><p>path(0,4)为2，说明想要到顶点4需要经过顶点2，路径0-&gt;2-&gt;4，此时再看path(0,2)为1，说明想要从0到2需要经过顶点1，路径变为0-&gt;1-&gt;2-&gt;4</p><p>关于代码的详细描述过程，见文章：<a href="https://www.cnblogs.com/wangyuliang/p/9216365.html">Floyd-傻子也能看懂的弗洛伊德算法（转）</a></p>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 数据结构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 最短路径 </tag>
            
            <tag> Dijkstra </tag>
            
            <tag> Floyd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo相关命令语法</title>
      <link href="hexo%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95/"/>
      <url>hexo%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="1-相关命令"><a class="markdownIt-Anchor" href="#1-相关命令"></a> 1. 相关命令</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#初始化一个hexo博客</span></span><br><span class="line">hexo init blog</span><br><span class="line"><span class="comment">#创建新页面</span></span><br><span class="line">hexo new page 页面名</span><br><span class="line"><span class="comment">#清理之前生成的旧文件</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="comment">#重新生成静态文件 下面是简写</span></span><br><span class="line">hexo generate</span><br><span class="line">hexo g</span><br><span class="line"><span class="comment">#本地预览 下面是简写</span></span><br><span class="line">hexo server</span><br><span class="line">hexo s</span><br><span class="line"><span class="comment">#合并写法</span></span><br><span class="line">hexo clean | hexo g | hexo s</span><br><span class="line"><span class="comment">#通过git提交到仓库,需要配置hexo项目的_config.yml文件</span></span><br><span class="line">hexo deploy</span><br><span class="line">hexo d</span><br><span class="line"><span class="comment">#当安装七牛云同步插件后,可以通过如下命令将hexo根目录下的static文件夹同步到七牛云</span></span><br><span class="line">hexo qiniu sync</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu s</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu sync2</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu s2</span><br></pre></td></tr></table></figure><h1 id="2-引用站内文章"><a class="markdownIt-Anchor" href="#2-引用站内文章"></a> 2. 引用站内文章</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% post_link 文章文件名（不要后缀） 文章标题（可选） %&#125;</span><br></pre></td></tr></table></figure><h1 id="3-引用图片"><a class="markdownIt-Anchor" href="#3-引用图片"></a> 3. 引用图片</h1><h2 id="31-引用七牛云图片"><a class="markdownIt-Anchor" href="#31-引用七牛云图片"></a> 3.1 引用七牛云图片</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% qnimg 图片.格式 alt:这是图片 title:这是图片 %&#125;</span><br></pre></td></tr></table></figure><p>不过这种方式引用图片，还是相当于本地存储，之后引用的图片会出现在需要上传的public目录中，还是会占用空间。</p><h2 id="32-引用本地图片"><a class="markdownIt-Anchor" href="#32-引用本地图片"></a> 3.2 引用本地图片</h2><p>倘若hexo项目的配置文件中将<code>post_asset_folder</code>设置为<code>true</code>，可以通过以下方式来引入图片，需要将example放入<code>source/_post</code>下的文章同名文件夹下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_path slug %&#125;</span><br><span class="line">&#123;% asset_img slug [title] %&#125;</span><br><span class="line">&#123;% asset_link slug [title] %&#125;</span><br><span class="line">&#123;% asset_img example.jpg This is an example image %&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>排序</title>
      <link href="%E6%8E%92%E5%BA%8F/"/>
      <url>%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p><img data-src="http://resource.silverbeats.cn/static/images/bg_06.jpg" alt="" /></p><h1 id="1-插入排序"><a class="markdownIt-Anchor" href="#1-插入排序"></a> 1. 插入排序</h1><h2 id="11-直接插入排序"><a class="markdownIt-Anchor" href="#11-直接插入排序"></a> 1.1 直接插入排序</h2><p>直接插入排序，思想较为简单。</p><p>可以类比平常打扑克抓牌的过程。每次抓一张牌时，都会将这张牌与之前手里的牌（之前手里的牌是有序的）进行比较（从左向右比，或者从右向左比），得到一个最终的插入位置，然后插入。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接插入排序, 假定前面是有序的，从乱序的后面取一个数插入有序的前面</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">0</span> || len == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">// 进行插入排序</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &lt; arr[j - <span class="number">1</span>]) &#123;</span><br><span class="line">        swap(arr, j, j - <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 交换</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> temp = arr[a];</span><br><span class="line">  arr[a] = arr[b];</span><br><span class="line">  arr[b] = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/insertSort_process.png"><p>上面的代码可以再简化一下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 直接插入排序, 假定前面是有序的，从乱序的后面取一个数插入有序的前面</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">0</span> || len == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">// 进行插入排序</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt; <span class="number">0</span> &amp;&amp; arr[j] &lt; arr[j - <span class="number">1</span>]; j--)</span><br><span class="line">    swap(arr, j, j - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-折半插入排序"><a class="markdownIt-Anchor" href="#12-折半插入排序"></a> 1.2 折半插入排序</h2><p>直接插入排序确定位置是通过将待排序的元素，与前面有序的序列一个个比较过去，从而得到最终的插入位置。那么，因为是顺序存储，利用数组实现排序，可以对前面的有序序列使用折半查找来确定最终插入位置。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">binaryInsertSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">0</span> || len == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">// low high mid用于折半查找</span></span><br><span class="line">  <span class="keyword">int</span> low, high, mid;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    low = <span class="number">0</span>;</span><br><span class="line">    high = i - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">      <span class="comment">// (high+low)/2 这样的写法可能会超出int的表示范围</span></span><br><span class="line">      mid = low + ((high - low) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> (arr[mid] &lt; arr[i])</span><br><span class="line">        low = mid + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        high = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// high + 1就是插入的位置</span></span><br><span class="line">    <span class="keyword">int</span> temp = arr[i];</span><br><span class="line">    <span class="comment">// 找到插入位置后,对元素进行挪动</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt; high; j--)</span><br><span class="line">      arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">    <span class="comment">// 将待排序的元素插入找到的位置</span></span><br><span class="line">    arr[high + <span class="number">1</span>] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="13-希尔排序"><a class="markdownIt-Anchor" href="#13-希尔排序"></a> 1.3 希尔排序</h2><p>希尔排序又称为缩小增量排序，当增量为1时，其实就是直接插入排序。增量的选取一般两种方案：</p><ul><li>希尔提出，对数组长度不断折半。比如数组长度是32，则增量dk分别是：16,8,4,2,1</li><li>帕佩尔诺夫和斯塔舍维奇提出，dk = 2<sup>k</sup> + 1，dk &lt; 数组长度，k ≥ 0。比如数组长度是32，此时k 只能从4开始，则k = 4，dk = 17；k = 3，dk = 9；k = 2，dk = 5；k = 1，dk = 3；此时还需要额外添加dk = 1，算是一个兜底作用。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 希尔排序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] shellSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">0</span> || len == <span class="number">1</span>) <span class="keyword">return</span> arr;</span><br><span class="line">  <span class="keyword">int</span> dk = len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (dk != <span class="number">0</span>) &#123;</span><br><span class="line">    shell_InsertSort(arr, dk);</span><br><span class="line">    <span class="comment">// shell_BinaryInsertSort(arr, dk);</span></span><br><span class="line">    dk = dk &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@Title</span>: shell_InsertSort</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@Description</span>: 希尔排序，直接插入法进行排序</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> ar: 数组</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> dk: 间隔</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shell_InsertSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> dk)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">int</span> i, j;</span><br><span class="line">  <span class="keyword">for</span> (i = dk; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> temp = arr[i];</span><br><span class="line">    <span class="keyword">for</span> (j = i - dk; j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; temp; j -= dk) &#123;</span><br><span class="line">      arr[j + dk] = arr[j];</span><br><span class="line">      arr[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@Title</span>: shell_BinaryInsertSort</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@Description</span>: 希尔排序，折半插入法进行排序</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> arr: 数组</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> dk: 间隔</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">shell_BinaryInsertSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> dk)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i, j, high, low, mid, temp;</span><br><span class="line">  <span class="keyword">for</span> (i = dk; i &lt; arr.length; i++) &#123;</span><br><span class="line">    low = i % dk;</span><br><span class="line">    high = i - dk;</span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">      mid = low + (high - low) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">if</span> (arr[mid] &lt; arr[i])</span><br><span class="line">        low = mid + dk;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        high = mid - dk;</span><br><span class="line">    &#125;</span><br><span class="line">    temp = arr[i];</span><br><span class="line">    <span class="comment">// high + dk 即为插入的位置</span></span><br><span class="line">    <span class="keyword">for</span> (j = i - dk; j &gt; high; j -= dk)</span><br><span class="line">      arr[j + dk] = arr[j];</span><br><span class="line">    arr[high + dk] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>后面那个通过折半插入法进行排序纯属练手，效率远远不及直接插入法希尔排序</p><p>前者，规模1W，20次，19ms</p><p>前者，规模10W，20次，187ms</p><p>后者，规模1W，20次，129ms</p><p>后者，规模10W，20次，10761ms</p><p>估计是在dk较小的时候，序列基本有序，折半插入的话是不管有没有序都得比较那么多次，而直接插入是越有序越快。</p></blockquote><h1 id="2-选择排序"><a class="markdownIt-Anchor" href="#2-选择排序"></a> 2. 选择排序</h1><h2 id="21-堆排序"><a class="markdownIt-Anchor" href="#21-堆排序"></a> 2.1 堆排序</h2><p>堆又分大根堆和小根堆，倘若要升序，选择大根堆，倘若要降序，选择小根堆。</p><p>大根堆：根节点的数字不小于左右孩子的值</p><p>小根堆：根节点的值不大于左右孩子的值</p><p>堆排序是把一个数组，看做是一颗完全二叉树，排序步骤：</p><ul><li>先对乱序的数组建立大根堆，可以得到数组的第一个元素（看做完全二叉树的话就是根节点）就是最大的</li><li>将其与数组最后面的那个值交换，然后重新调整，变为大根堆</li><li>依次类推</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 堆排序</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 首先构建大根堆</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> pos = arr.length/<span class="number">2</span> - <span class="number">1</span>; pos &gt;= <span class="number">0</span>; --pos) &#123;</span><br><span class="line">    <span class="comment">//从第一个非叶子结点从下至上，从右至左调整结构</span></span><br><span class="line">    adjustHeap(arr, pos, arr.length);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 经过上一步可以得到大根堆,现在开始排序</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> j = arr.length - <span class="number">1</span>; j &gt; <span class="number">0</span>; --j) &#123;</span><br><span class="line">    <span class="comment">//将堆顶元素与末尾元素进行交换</span></span><br><span class="line">    swap(arr,<span class="number">0</span>, j);</span><br><span class="line">    <span class="comment">//重新对堆进行调整</span></span><br><span class="line">    adjustHeap(arr,<span class="number">0</span>, j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调整为大根堆</span></span><br><span class="line"><span class="comment">// arr是要调整的数组, i是要调整的数组下标, length是调整的范围</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">adjustHeap</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> pos, <span class="keyword">int</span> length)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 临时存储被调整的数组数据</span></span><br><span class="line">  <span class="keyword">int</span> temp = arr[pos];</span><br><span class="line">  <span class="comment">// pos是被调整元素的数组下标, 2*pos+1 是其左孩子 2*pos + 2是其右孩子</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = pos*<span class="number">2</span> + <span class="number">1</span>; i &lt; length; i = i*<span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    前面的判断条件保证它的右孩子是无序的,</span></span><br><span class="line"><span class="comment">    在堆排序过程中会将最大值不断放到后面, length就是限制条件,可以通过这个条件让有序的右孩子不被波及</span></span><br><span class="line"><span class="comment">    这个if保证i的下标对应的值是两个孩子中最大的那一个</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span>(i + <span class="number">1</span> &lt; length &amp;&amp; arr[i] &lt; arr[i + <span class="number">1</span>]) &#123;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果根节点小于它的孩子,则交换</span></span><br><span class="line">    <span class="keyword">if</span>(temp &lt; arr[i]) &#123;</span><br><span class="line">      <span class="comment">// 交换根节点和它孩子的值</span></span><br><span class="line">      swap(arr, pos, i);</span><br><span class="line">      <span class="comment">// 因为经过了调整,当被调整的节点挪了位置,可能会导致后面的序列出问题,所以需要让pos定到i这个位置</span></span><br><span class="line">      pos = i;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="22-简单选择排序"><a class="markdownIt-Anchor" href="#22-简单选择排序"></a> 2.2 简单选择排序</h2><p>思路简单：每次选择最大排到后面，或者每次选择最小的排到最前面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 每次过滤一遍数组将最小值放到前面</span></span><br><span class="line">  <span class="keyword">int</span> i, j, min;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    min = i; <span class="comment">// 假定第i个位置最小</span></span><br><span class="line">    <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &lt; arr[min])</span><br><span class="line">        min = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i != min) swap(arr, i, min);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是另外一种做法，是每次将最小的放到最前面，最大的放到最后面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectSort_2</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 每次过滤一遍数组将最小值放到前面</span></span><br><span class="line">  <span class="comment">// 将最大的数字放到最后面</span></span><br><span class="line">  <span class="keyword">int</span> i, j, min, max, lastPos;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= arr.length &gt;&gt; <span class="number">1</span>; i++) &#123;</span><br><span class="line">    min = max = i;</span><br><span class="line">    lastPos = arr.length - i - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt;= lastPos; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &lt; arr[min])</span><br><span class="line">        min = j;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &gt; arr[max])</span><br><span class="line">        max = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i != min)</span><br><span class="line">      swap(arr, i, min);</span><br><span class="line">    <span class="keyword">if</span> (lastPos != max)</span><br><span class="line">      swap(arr, max, lastPos);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>前者，规模10W，20次，54408ms，2720ms/次</p><p>后者，规模10W，20次，53938ms，2697ms/次</p><p>呵呵……</p></blockquote><p>简单选择排序有两个版本，一种是如同上面的两种写法一样，将最大值（最小值）与序列最后（第一）个进行调换位置，这个版本成为<mark>交换版</mark></p><p>另一种版本是将最大值（最小值）插入到序列的最后（最前）面，成为插入版。</p><p>区别在于：</p><ul><li>交换版不稳定，插入版稳定</li><li>倘若序列顺序存储，插入版会涉及到大批量的元素挪动，不如交换版来的划算</li><li>倘若序列是链式存储，插入版会划算一些</li></ul><h1 id="3-交换排序"><a class="markdownIt-Anchor" href="#3-交换排序"></a> 3. 交换排序</h1><h2 id="31-冒泡排序"><a class="markdownIt-Anchor" href="#31-冒泡排序"></a> 3.1 冒泡排序</h2><p>冒泡排序很经典，每次排序都能讲最大的数字排到最后，或者将最小的数字排到最前面</p><blockquote><p>听说冒泡是毒瘤，比较次数和交换次数超级多</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] bubbleSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">0</span> || len == <span class="number">1</span>) <span class="keyword">return</span> arr;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="comment">// 倘若内循环没有进行交换,则整个序列有序,会直接终止整个排序,是一个优化的地方</span></span><br><span class="line">    <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">        swap(arr, j, j + <span class="number">1</span>);</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>继续发挥，双向冒泡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 双向冒泡</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bubble2Ways</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> left = <span class="number">0</span>, right = arr.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">boolean</span> flag;</span><br><span class="line">  <span class="keyword">while</span>(left &lt; right) &#123;</span><br><span class="line">    flag = <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">// 从左往右将最大的数字挪到最右边</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = left; i &lt; right; ++i) &#123;</span><br><span class="line">      <span class="keyword">if</span>(arr[i] &gt; arr[i + <span class="number">1</span>])&#123;</span><br><span class="line">        swap(arr, i, i + <span class="number">1</span>);</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 挪到结束后right--</span></span><br><span class="line">    --right;</span><br><span class="line">    <span class="comment">// 从右往左将最小的数字挪到最左边</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = right; j &gt; <span class="number">0</span>; --j) &#123;</span><br><span class="line">      <span class="keyword">if</span>(arr[j] &lt; arr[j - <span class="number">1</span>])&#123;</span><br><span class="line">        swap(arr, j, j - <span class="number">1</span>);</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++left;</span><br><span class="line">    <span class="keyword">if</span>(!flag)<span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>前者，规模1W，20次，1362ms，68ms/次</p><p>后者，规模1W，20次，1445ms，72ms/次</p><p>前者，规模10W，20次，303042ms，5min，15152ms/次</p><p>后者，规模10W，20次，202945ms，3min23s，10147ms/次</p><p>……还是有点提高的</p></blockquote><h2 id="32-快速排序"><a class="markdownIt-Anchor" href="#32-快速排序"></a> 3.2 快速排序</h2><p>利用分而治之的思想。每一次快速排序会实现这样的结果：</p><ul><li>该数字的左边都比它小</li><li>该数字的右边都不小于它</li><li>每一次排序都会确定一个数的最终位置</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 快速排序</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">QSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (low &lt; high) &#123;</span><br><span class="line">    <span class="keyword">int</span> piovtpos = <span class="keyword">this</span>.QSort_Partition(arr, low, high);</span><br><span class="line">    <span class="comment">// 排左边</span></span><br><span class="line">    QSort(arr, low, piovtpos - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 排右边</span></span><br><span class="line">    QSort(arr, piovtpos + <span class="number">1</span>, high);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 一趟快速排序</span></span><br><span class="line"><span class="comment">// 参数1：数组,参数2：数组的起始位置,参数3：数组的终了位置,闭区间</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">QSort_Partition</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 指定基准</span></span><br><span class="line">  <span class="keyword">int</span> base = arr[left];</span><br><span class="line">  <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right &amp;&amp; arr[right] &gt;= base) right--;</span><br><span class="line">    <span class="keyword">if</span> (left &lt; right) arr[left] = arr[right];</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right &amp;&amp; arr[left] &lt; base) left++;</span><br><span class="line">    <span class="keyword">if</span> (left &lt; right) arr[right] = arr[left];</span><br><span class="line">  &#125;</span><br><span class="line">  arr[left] = base;</span><br><span class="line">  <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>平均时间复杂度为nlogn的算法中，如：堆排序，快速排序，希尔排序，归并排序中，快速排序前面系数最小</p><p>规模1W，20次，15ms</p><p>规模10W，20次，359ms</p><p>快速排序有其特点：<mark>越有序越慢，越无序越快</mark></p></blockquote><h1 id="4-二路归并排序"><a class="markdownIt-Anchor" href="#4-二路归并排序"></a> 4. 二路归并排序</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>: mergeSort</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 归并排序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr: int类型数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> leftStart, <span class="keyword">int</span> rightBound)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(leftStart == rightBound)<span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(leftStart &gt; rightBound || leftStart &lt; <span class="number">0</span> || rightBound &lt; <span class="number">0</span>)<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="keyword">int</span> mid = leftStart + ((rightBound - leftStart) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  mergeSort(arr,leftStart,mid);</span><br><span class="line">  mergeSort(arr,mid+<span class="number">1</span>,rightBound);</span><br><span class="line">  merge(arr, leftStart, mid+<span class="number">1</span>, rightBound);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>: merge</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:一次归并,将两个有序的数组合并，仍有序</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr 数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> leftStart 第一个数组的左边界开始的位置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> rightStart 第二个数组的左边界开始的位置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> rightBound 第二个数组的右边界结束的位置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>: void</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> leftStart, <span class="keyword">int</span> rightStart, <span class="keyword">int</span> rightBound)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 合并思想：新建一个数组，每次将小的数字放到新建的数组中</span></span><br><span class="line">  <span class="keyword">int</span> i = leftStart, j = rightStart, k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span>[] tempArr = <span class="keyword">new</span> <span class="keyword">int</span>[rightBound - leftStart + <span class="number">1</span>];</span><br><span class="line">  <span class="keyword">while</span>(i &lt; rightStart &amp;&amp; j&lt;= rightBound)</span><br><span class="line">    tempArr[k++] = arr[i] &lt;= arr[j]?arr[i++]:arr[j++];</span><br><span class="line">  <span class="comment">// 倘若还有剩余</span></span><br><span class="line">  <span class="keyword">while</span>(i &lt; rightStart)</span><br><span class="line">    tempArr[k++] = arr[i++];</span><br><span class="line">  <span class="keyword">while</span>(j &lt;= rightBound)</span><br><span class="line">    tempArr[k++] = arr[j++];</span><br><span class="line">  <span class="comment">// 此时tempArr就是合并好有序的数组，对原始数组进行覆盖</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> p = leftStart; p &lt;= rightBound; p++)</span><br><span class="line">    arr[p] = tempArr[p - leftStart];</span><br><span class="line">  <span class="comment">// 对原数组进行覆盖可以使用System.arraycopy,可以提高效率</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  if (i &lt; rightStart) &#123;</span></span><br><span class="line"><span class="comment">    System.arraycopy(arr, i, tempArr, k, rightStart - i);</span></span><br><span class="line"><span class="comment">    k += (rightStart - i);</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  if (j &lt;= rightBound) &#123;</span></span><br><span class="line"><span class="comment">    System.arraycopy(arr, j, tempArr, k, rightBound - j + 1);</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  System.arraycopy(tempArr, 0, arr, leftStart, tempArr.length);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>规模1W，20次，32ms</p><p>规模10W，20次，241ms</p></blockquote><h1 id="5-桶排序"><a class="markdownIt-Anchor" href="#5-桶排序"></a> 5. 桶排序</h1><h2 id="51-基数排序"><a class="markdownIt-Anchor" href="#51-基数排序"></a> 5.1 基数排序</h2><h3 id="511-完整代码只适用于非负数"><a class="markdownIt-Anchor" href="#511-完整代码只适用于非负数"></a> 5.1.1 完整代码（只适用于非负数）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基数排序</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">radixSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">int</span> arrMax = getMinMax(arr)[<span class="number">1</span>];</span><br><span class="line">  <span class="comment">// 从个位开始,对数组进行排序</span></span><br><span class="line">  <span class="comment">// exp = 1, 按照个位</span></span><br><span class="line">  <span class="comment">// exp = 10, 按照十位</span></span><br><span class="line">  <span class="comment">// exp = 100, 按照百位</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> exp = <span class="number">1</span>; arrMax / exp &gt; <span class="number">0</span>; exp *= <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">// 存储被排序数组的临时数组</span></span><br><span class="line">    <span class="keyword">int</span>[] output = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">    <span class="comment">// 桶,因为不管是什么数字,个数十位不管是哪一位,都是0-9，所以桶数组的长度是10</span></span><br><span class="line">    <span class="keyword">int</span>[] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="comment">// 将数据出现的次数进行统计</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">      buckets[(arr[i] / exp) % <span class="number">10</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 转为累加数组。目的是让更改后的buckets[i]的值，是该数据在output中的位置</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">      buckets[i] += buckets[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将数据存储到临时数组output中</span></span><br><span class="line">    <span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      output[buckets[(arr[i] / exp) % <span class="number">10</span>] - <span class="number">1</span>] = arr[i];</span><br><span class="line">      buckets[(arr[i] / exp) % <span class="number">10</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将排序好的数组赋值给arr</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">      arr[i] = output[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="512-分段说明"><a class="markdownIt-Anchor" href="#512-分段说明"></a> 5.1.2 分段说明</h3><p><mark><strong>分段说明举例说明的乱序数组为：{53, 3, 542, 748, 14, 214, 154, 63, 616}，为了更好的说明过程，for循环的说明将会以个位排序，演示整个过程</strong></mark></p><h4 id="5121-外层循环"><a class="markdownIt-Anchor" href="#5121-外层循环"></a> 5.1.2.1 外层循环</h4><p>arrMax是整个数组中最大的数字，同时也是位数最多的那个数字，比如arrMax是748，那么需要进行3次循环，分别对整个数组的个位，十位，百位来进行排序，故，外层循环的次数是由arrMax的位数来决定的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> exp = <span class="number">1</span>; arrMax / exp &gt; <span class="number">0</span>; exp *= <span class="number">10</span>) &#123;</span><br><span class="line">……   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>exp  =  1，arrMax = 748/1  = 748&gt; 0，对个位进行排序</li><li>exp = 10，arrMax = 748/10  = 74 &gt; 0，对十位进行排序</li><li>exp = 100，arrMax = 748/100  = 8 &gt; 0，对百位进行排序</li><li>exp = 1000，arrMax = 748/1000  = 0 &gt; 0，false，中止外层循环</li></ul><h4 id="5122-内部循环两个辅助数组的作用"><a class="markdownIt-Anchor" href="#5122-内部循环两个辅助数组的作用"></a> 5.1.2.2 内部循环两个辅助数组的作用</h4><p>首先，先来看一下，我们熟知的基数排序的过程：</p><p><img data-src="http://resource.silverbeats.cn/static/images/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F%E8%BF%87%E7%A8%8B.png" alt="基数排序过程" /></p><p>很清楚能知道，其中一个辅助数组为buckets长度为10，即为上面的桶。但问题是，模拟的时候，是将每个数字放入桶中，然后取出的顺序是放入的先后顺序一致，颇有一种每个桶里面放的都是一个队列，先进先出，这样想倒是很符合，很自然，可以声明一个Object[]数组，之后每个位置存储一个队列，队列不需要自己实现，可以使用java.util包下的Queue实现类，之后操作就比较简单了，完全就和手动模拟的过程是一致的。（倘若用C语言，这样想能恶心死你= =）</p><p>但上面这种考虑虽然简单，但空间复杂度肯定是小不了的，这里给出的是另外一种比较巧妙的解决方案。可见后面更为详细的过程图。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存储被排序数组的临时数组</span></span><br><span class="line"><span class="keyword">int</span>[] output = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line"><span class="comment">// 桶,因为不管是什么数字,个数十位不管是哪一位,都是0-9，所以桶数组的长度是10</span></span><br><span class="line"><span class="keyword">int</span>[] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br></pre></td></tr></table></figure><h4 id="5123-内部四for第一for-将数据出现的次数进行统计"><a class="markdownIt-Anchor" href="#5123-内部四for第一for-将数据出现的次数进行统计"></a> 5.1.2.3 内部四for第一for: 将数据出现的次数进行统计</h4><p><code>(arr[i]/exp)%10</code>的目的是要获得目标位置的数字。</p><p>首先，将需要的那一位变为个位，比如214，想要取得十位1，此时的exp = 10，先要除exp，得到21，这样想要的十位数字1就挪到了个位，之后让21 % 10，即可得到想要的十位数字1</p><p>这里的for循环其实目的是统计每个数字的exp位（exp = 1 表示每个数字的个位，exp = 10 表示每个数字的十位……）出现的次数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  buckets[(arr[i] / exp) % <span class="number">10</span>]++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>以个排序演示完整过程，出现次数：为待排序数组，每个数字的个位出现的次数</strong></p><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第一for.png" alt="基数排序_分段说明第一for" style="zoom:67%;" /><h4 id="5124-内部四for第二for-转为累加数组"><a class="markdownIt-Anchor" href="#5124-内部四for第二for-转为累加数组"></a> 5.1.2.4 内部四for第二for: 转为累加数组</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转为累加数组。目的是让更改后的buckets[i]的值，是该数据在output中的位置</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  buckets[i] += buckets[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第二for.png" alt="基数排序_分段说明第二for.png"><p>这个累加数组中的值，就代表了每个数字最终应该存储的位置。比如53这个数字，当按照个位排完序，应该在哪里？</p><p>首先，我们应该能想到应该要遍历待排序数组，然后按照某种规则放入用来临时存储的output数组中。那么问题来了，应该正向遍历，还是逆向遍历？</p><p>假设是正向遍历，遍历到每个数字都需要考虑一些问题：</p><ul><li>有多少个数字在我前面</li><li>和我拥有相同的个位，有多少个，还有多少个没有被安排进临时数组</li><li>比如，第一个数字53，首先，获取53的个位数字3，对应到buckets数组中发现buckets[3] = 4，说明最后一个个位为3的数字应该排在第四个。通过buckets[2] = 1，说明能排在个位3前面的数字只有1个，能推出，在最后的排序结果中，以3为个位的数字应该排在序列的第2,3,4位置。问题来了，如何确定到底是那个位置，同时还要保证相同个位的数字之间相对位置不变。</li></ul><p>假设是逆序，它天然就能保证在最终结果序列中，相同个位之间相对顺序不变。比如063。</p><ul><li>buckets[3] = 4，让063排第4位，buckets[3] = 3</li><li>buckets[3] = 3，让003排第3位，buckets[3] = 2</li><li>buckets[2] = 2，让053排第2位，buckets[3] = 1</li></ul><p>这个逻辑写起来就会很轻松。</p><h4 id="5125-内部四for第三for-将数据存储到临时数组output中"><a class="markdownIt-Anchor" href="#5125-内部四for第三for-将数据存储到临时数组output中"></a> 5.1.2.5 内部四for第三for: 将数据存储到临时数组output中</h4><p>这里是整个排序中最不好懂的一部分。但是当你看到上面的说明，这里就会比较容易去理解。为了方便理解，将源代码中的两行代码拆分。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 将数据存储到临时数组output中</span></span><br><span class="line"><span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">  <span class="comment">// 获取这个数字的exp位</span></span><br><span class="line">  <span class="keyword">int</span> pos = (arr[i] / exp) % <span class="number">10</span>;</span><br><span class="line">  <span class="comment">// 对应到buckets数组</span></span><br><span class="line">  <span class="keyword">int</span> b = buckets[pos];</span><br><span class="line">  <span class="comment">// 数组下标从0开始,需要减1,才是arr[i]应该存储的地方</span></span><br><span class="line">  output[--b] = arr[i];</span><br><span class="line">  <span class="comment">// 让桶的数字自减</span></span><br><span class="line">  buckets[pos]--;</span><br><span class="line">  <span class="comment">//output[buckets[(arr[i] / exp) % 10] - 1] = arr[i];</span></span><br><span class="line">  <span class="comment">//buckets[(arr[i] / exp) % 10]--;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>第1次：616，获取个位6，buckets[6] = 8，需要减1才是存放处，output[8 - 1] = 616，桶的数字减1，buckets[6] = 7</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_01.png" alt="基数排序_分段说明第三for_01"><ul><li>第2次：063，获取个位3，buckets[3] = 4，需要减1才是存放处，output[4 - 1] = 063，桶的数字减1，buckets[3] = 3</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_02.png" alt="基数排序_分段说明第三for_02"><ul><li>第3次：154，获取个位4，buckets[4] = 7，需要减1才是存放处，output[7 - 1] = 154，桶的数字减1，buckets[4] = 6</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_03.png" alt="基数排序_分段说明第三for_03"><ul><li>第4次：214，获取个位4，buckets[4] = 6，需要减1才是存放处，output[6 - 1] = 124，桶的数字减1，buckets[4] = 5</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_04.png" alt="基数排序_分段说明第三for_04"><ul><li>第5次：014，获取个位4，buckets[4] = 5，需要减1才是存放处，output[5 - 1] = 014，桶的数字减1，buckets[4] = 4</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_05.png" alt="基数排序_分段说明第三for_05"><ul><li>第6次：748，获取个位8，buckets[8] = 9，需要减1才是存放处，output[9 - 1] = 748，桶的数字减1，buckets[8] = 8</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_06.png" alt="基数排序_分段说明第三for_06"><ul><li>第7次：542，获取个位2，buckets[2] = 1，需要减1才是存放处，output[1 - 1] = 542，桶的数字减1，buckets[2] = 0</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_07.png" alt="基数排序_分段说明第三for_07"><ul><li>第8次：003，获取个位3，buckets[3] = 3，需要减1才是存放处，output[3 - 1] = 003，桶的数字减1，buckets[3] = 2</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_08.png" alt="基数排序_分段说明第三for_08"><ul><li>第9次：053，获取个位3，buckets[3] = 2，需要减1才是存放处，output[2 - 1] = 053，桶的数字减1，buckets[3] = 1</li></ul><img data-src="http://resource.silverbeats.cn/static/images/基数排序_分段说明第三for_09.png" alt="基数排序_分段说明第三for_09"><h3 id="513-完整代码适用于负数"><a class="markdownIt-Anchor" href="#513-完整代码适用于负数"></a> 5.1.3 完整代码（适用于负数）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">radixSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len = arr.length;</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">1</span> ||len == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">int</span>[] temp = getMinMax(arr);</span><br><span class="line">  <span class="comment">// 应该是位数最多的那一个</span></span><br><span class="line">  <span class="keyword">int</span> arrMax = Math.max(Math.abs(temp[<span class="number">0</span>]), Math.abs(temp[<span class="number">1</span>]));</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> exp = <span class="number">1</span>; arrMax / exp != <span class="number">0</span>; exp *= <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">// 存储被排序数组的临时数组</span></span><br><span class="line">    <span class="keyword">int</span>[] output = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">    <span class="comment">// 桶,因为要考虑负数,桶编号从-9~9,，所以桶数组的长度是19</span></span><br><span class="line">    <span class="keyword">int</span>[] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">19</span>];</span><br><span class="line">    <span class="comment">// 将数据出现的次数进行统计,其中buckets数组下标0-8代表-9~-1,下标9代表0,10-18代表1-9</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="comment">//获取这一位</span></span><br><span class="line">      <span class="keyword">int</span> bit = arr[i]/exp % <span class="number">10</span>;</span><br><span class="line">      buckets[bit + <span class="number">9</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 转为累加数组。目的是让更改后的buckets[i]的值，是该数据在output中的位置</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; buckets.length; i++) &#123;</span><br><span class="line">      buckets[i] += buckets[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将数据存储到临时数组output中</span></span><br><span class="line">    <span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      output[buckets[(arr[i] / exp) % <span class="number">10</span> + <span class="number">9</span>] - <span class="number">1</span>] = arr[i];</span><br><span class="line">      buckets[(arr[i] / exp) % <span class="number">10</span> + <span class="number">9</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将排序好的数组赋值给arr</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">      arr[i] = output[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>首先和上面不包含负数的基数排序相比，变动的地方如下：</p><ul><li>arrMax</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] temp = getMinMax(arr);</span><br><span class="line"><span class="keyword">int</span> arrMax = Math.max(Math.abs(temp[<span class="number">0</span>]), Math.abs(temp[<span class="number">1</span>]));</span><br></pre></td></tr></table></figure><blockquote><p>实际上，arrMax的意义其实没有变化，都指的是这一串数字当中位数最多的那个数字，至于是正的还是负的，这无所谓，只要它位数最多。</p><p>所以，倘若这串数字包含负数，在获取位数最多的那个数字，可以这样获取。</p><p>其中getMinMax是获取arr中的最小值和最大值，返回值{min，max}</p></blockquote><ul><li>桶数组大小变动</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">19</span>];</span><br><span class="line"><span class="comment">// 将数据出现的次数进行统计,其中buckets数组下标0-8代表-9~-1,下标9代表0,10-18代表1-9</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="comment">//获取这一位</span></span><br><span class="line">  <span class="keyword">int</span> bit = arr[i]/exp % <span class="number">10</span>;</span><br><span class="line">  buckets[bit + <span class="number">9</span>]++;</span><br><span class="line">&#125;</span><br><span class="line">……</span><br><span class="line"><span class="comment">// 将数据存储到临时数组output中</span></span><br><span class="line"><span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">  output[buckets[(arr[i] / exp) % <span class="number">10</span> + <span class="number">9</span>] - <span class="number">1</span>] = arr[i];</span><br><span class="line">  buckets[(arr[i] / exp) % <span class="number">10</span> + <span class="number">9</span>]--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>因为要考虑到负数，应该有：-9，-8，-7，-6，……，0，1，2，……，9共计19个桶</p><p>因为数组下标是从0开始的，所以在第一个计数的for循环，当在得到该数字的某一位时，需要+9</p><p>同时在第三个for循环，在获取某个桶的值的时候，也需要+9</p></blockquote><h2 id="52-计数排序"><a class="markdownIt-Anchor" href="#52-计数排序"></a> 5.2 计数排序</h2><p>利用桶，空间换时间，在面对在一定范围内的大量重复数字的场景下，很适用。</p><p>比如一个省的高考成绩排名，可以声明一个长度为751的计数数组，其数组下标为0-750，代表每个分数。之后遍历整个省的所有人，统计每个分数的出现的次数，然后再遍历计数数组，即可实现有序。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Title</span>: countSort</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:计数排序,适用于数字的范围小，排序量大的数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr 数组</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> min 该数组中的最小值</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> max 该数组中的最大值</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>: int[]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">countSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> min, <span class="keyword">int</span> max)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// arr的最小值到最大值之间的数字，即为countArr的下标</span></span><br><span class="line">  <span class="keyword">int</span>[] countArr = <span class="keyword">new</span> <span class="keyword">int</span>[max - min + <span class="number">1</span>];</span><br><span class="line">  <span class="comment">// 统计arr中每个数字出现的次数</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; arr.length; j++)</span><br><span class="line">    countArr[arr[j] - min]++;</span><br><span class="line">  <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">  <span class="comment">// 将countArr变为累加数组,这一步主要是实现算法稳定</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">1</span>; m &lt; countArr.length; m++)</span><br><span class="line">    countArr[m] += countArr[m - <span class="number">1</span>];</span><br><span class="line">  <span class="comment">// 这一步参见基数排序的过程示意图</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> k = arr.length - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)</span><br><span class="line">    res[--countArr[arr[k] - min]] = arr[k];</span><br><span class="line">  <span class="comment">// 将排序好的数组赋值给arr</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    arr[i] = res[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="6-排序比较"><a class="markdownIt-Anchor" href="#6-排序比较"></a> 6. 排序比较</h1><table><thead><tr><th>排序</th><th>英文</th><th>平均</th><th>最坏</th><th>最好</th><th>空间</th><th>稳定性</th></tr></thead><tbody><tr><td>插入排序</td><td>Insertion</td><td>n<sup>2</sup></td><td>n<sup>2</sup></td><td>n</td><td>1</td><td>稳</td></tr><tr><td>折半插入</td><td></td><td>n<sup>2</sup></td><td>n<sup>2</sup></td><td>nlog<sub>2</sub>n</td><td>1</td><td>稳</td></tr><tr><td>希尔排序</td><td>Shell</td><td>n<sup>1.3</sup></td><td>n<sup>2</sup></td><td>n</td><td>1</td><td>不稳</td></tr><tr><td>堆排序</td><td>Heap</td><td>nlog<sub>2</sub>n</td><td>nlog<sub>2</sub>n</td><td>nlog<sub>2</sub>n</td><td>1</td><td>不稳</td></tr><tr><td>选择排序</td><td>Selection</td><td>n<sup>2</sup></td><td>n<sup>2</sup></td><td>n<sup>2</sup></td><td>1</td><td>不稳</td></tr><tr><td>冒泡排序</td><td>Bubble</td><td>n<sup>2</sup></td><td>n<sup>2</sup></td><td>n</td><td>1</td><td>稳</td></tr><tr><td>快速排序</td><td>Quick</td><td>nlog<sub>2</sub>n</td><td>n<sup>2</sup></td><td>nlog<sub>2</sub>n</td><td>log<sub>2</sub>n</td><td>不稳</td></tr><tr><td>归并排序</td><td>Merge</td><td>nlog<sub>2</sub>n</td><td>nlog<sub>2</sub>n</td><td>nlog<sub>2</sub>n</td><td>n</td><td>稳</td></tr><tr><td>桶排序</td><td>Bucket</td><td>n+k</td><td>n<sup>2</sup></td><td>n</td><td>n+k</td><td>稳</td></tr><tr><td>计数排序</td><td>Counting</td><td>n+k</td><td>n+k</td><td>n+k</td><td>n+k</td><td>稳</td></tr><tr><td>基数排序</td><td>Radix</td><td>n*k</td><td>n*k</td><td>n*k</td><td>n+k</td><td>稳</td></tr></tbody></table><ul><li>经过一趟排序能够使某个关键字到达最终位置的排序：交换类排序（冒泡，快速排序）、选择类排序（简单选择，堆排序）</li><li>排序算法的关键字比较次数和原始序列无关：简单选择排序和折半插入排序</li><li>排序算法的排序趟数和原始序列有关：交换类排序（冒泡，快速排序）</li></ul>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 数据结构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 排序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo之yelee主题配置</title>
      <link href="hexo%E4%B9%8Byelee%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/"/>
      <url>hexo%E4%B9%8Byelee%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>参考文章：</p><ul><li><p><a href="https://www.jianshu.com/p/f9b213097c42">使用Github搭建Hexo技术博客托管在GitHub Pages上–安装教程</a></p></li><li><p><a href="https://www.jianshu.com/p/288ab888ac42">博客系统hexo yelee搭建历程</a></p></li><li><p><a href="https://blog.csdn.net/u010996565/article/details/89196612">hexo在文章中添加图片</a></p></li><li><p><a href="https://www.jianshu.com/p/6991e8e7f01b">Hexo七牛插件安装与使用</a></p></li><li><a href="/hexo%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95/" title="hexo相关命令语法">hexo相关命令语法</a></li></ul><p><img data-src="http://resource.silverbeats.cn/static/images/bg_05.png" alt="" /></p><h1 id="1-前期准备"><a class="markdownIt-Anchor" href="#1-前期准备"></a> 1. 前期准备</h1><ol><li><p>github账号、安装<a href="http://git-scm.com/">git</a></p></li><li><p><a href="http://nodejs.org">nodejs</a></p></li><li><p>notepad++或者editplus，记事本也可以</p></li><li><p>typora（后期写md格式文章用的软件）</p></li><li><p>可选内容</p><ul><li>修改node.js源</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 设置 淘宝镜像源</span><br><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line">// 查看使用的镜像源</span><br><span class="line">npm config get registry</span><br><span class="line">// 安装淘宝镜像源</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure></li></ol><h1 id="2-实操"><a class="markdownIt-Anchor" href="#2-实操"></a> 2. 实操</h1><h2 id="21-安装hexo框架"><a class="markdownIt-Anchor" href="#21-安装hexo框架"></a> 2.1 安装Hexo框架</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">// 或者</span><br><span class="line">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><h2 id="22-创建hexo项目"><a class="markdownIt-Anchor" href="#22-创建hexo项目"></a> 2.2 创建Hexo项目</h2><ul><li>在本地，选择要创建项目的目录</li><li>打开Git Bash（或者cmd命令行，或者powershell），并进入该目录</li><li>输入并运行<code>hexo init blog</code>之后，会在当前目录下创建blog文件夹，并初始化相关文件</li><li><code>cd blog</code>进入创建的项目，运行<code>npm install</code>下载相关依赖包</li></ul><h2 id="23-相关命令"><a class="markdownIt-Anchor" href="#23-相关命令"></a> 2.3 相关命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#清理之前生成的旧文件</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="comment">#重新生成静态文件 下面是简写</span></span><br><span class="line">hexo generate</span><br><span class="line">hexo g</span><br><span class="line"><span class="comment">#本地预览 下面是简写</span></span><br><span class="line">hexo server</span><br><span class="line">hexo s</span><br><span class="line"><span class="comment">#合并写法</span></span><br><span class="line">hexo clean | hexo g | hexo s</span><br><span class="line"><span class="comment">#通过git提交到仓库,需要配置,见后文</span></span><br><span class="line">hexo deploy</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><h2 id="24-下载yelee主题"><a class="markdownIt-Anchor" href="#24-下载yelee主题"></a> 2.4 下载yelee主题</h2><p>在当前目录下，输入命令<code>git clone https://github.com/MOxFIVE/hexo-theme-yelee themes/yelee</code>，倘若下载速度是龟速，不如直接用迅雷下zip压缩包来的快……</p><p><a href="https://pan.baidu.com/s/1OSbQMbU2MNL5xHQ7HambFg">Hexo主题压缩包，百度云，密码abcd</a></p><p>下载完成之后，需要修改项目目录下的<code>_config.yml</code>文件，找到<code>theme</code>主题字样，将后面的默认主题<code>landscape</code>修改为<code>yelee</code>。倘若之后想要更换主题也是如此。</p><h2 id="25-修改_configyml文件"><a class="markdownIt-Anchor" href="#25-修改_configyml文件"></a> 2.5 修改_config.yml文件</h2><h3 id="251-首页不显示文章列表"><a class="markdownIt-Anchor" href="#251-首页不显示文章列表"></a> 2.5.1 首页不显示文章列表</h3><p>启动后会发现左侧导航栏，点击主页后不显示文章列表</p><p>进入yelee模板页的 <code>_config.yml</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">search:</span> </span><br><span class="line">  <span class="attr">on:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onload:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment">## true: get search.xml file when the page has loaded</span></span><br><span class="line">  <span class="comment">## false: get the file when search box gets focus</span></span><br></pre></td></tr></table></figure><h3 id="252-相关链接无法跳转"><a class="markdownIt-Anchor" href="#252-相关链接无法跳转"></a> 2.5.2 相关链接无法跳转</h3><p>在<code>themes/yelee/_config.yml</code>中类似如下的内容。实际上当预览的时候会发现有相关的链接没有配置路由。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## About Page: `hexo new page about`</span></span><br><span class="line"><span class="comment">## Tags Cloud Page: `hexo new page tags`</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span></span><br><span class="line">  <span class="string">所有文章:</span> <span class="string">/archives/</span></span><br><span class="line">  <span class="string">随笔:</span> <span class="string">/note/</span></span><br><span class="line">  <span class="string">标签云:</span> <span class="string">/tags/</span></span><br><span class="line">  <span class="string">关于我:</span> <span class="string">/about/</span></span><br></pre></td></tr></table></figure><p>因为随笔、标签云、关于我这种链接，在此项目中是没有的，需要去创建。留意上方注释，已经说明如何创建。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在项目根目录下操作, 根据需要创建系统页</span></span><br><span class="line">hexo new page tags</span><br><span class="line">hexo new page about</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><h3 id="253-添加文章的字数统计和大概看完的时间"><a class="markdownIt-Anchor" href="#253-添加文章的字数统计和大概看完的时间"></a> 2.5.3 添加文章的字数统计和大概看完的时间</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#项目根路径下操作</span></span><br><span class="line">npm i -<span class="literal">-save</span> hexo<span class="literal">-wordcount</span></span><br></pre></td></tr></table></figure><p>文件配置：</p><ol><li>在<code>yelee/layout/_partial/post/word.ejs</code>下创建<code>word.ejs</code>文件：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--倘若出现tag标签和统计字数的文件有布局上的问题，可以对上下外边距进行调整--&gt;</span><br><span class="line">&lt;div style&#x3D;&quot;margin-top:10px;margin-bottom: 30px&quot;&gt;</span><br><span class="line">  &lt;span class&#x3D;&quot;post-time&quot;&gt;</span><br><span class="line">    &lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class="line">      &lt;i class&#x3D;&quot;fa fa-keyboard-o&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">      &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;  字数统计: &lt;&#x2F;span&gt;</span><br><span class="line">      &lt;span class&#x3D;&quot;post-count&quot;&gt;&lt;%&#x3D; wordcount(post.content) %&gt;字&lt;&#x2F;span&gt;</span><br><span class="line">    &lt;&#x2F;span&gt;</span><br><span class="line">  &lt;&#x2F;span&gt;</span><br><span class="line">  &lt;span class&#x3D;&quot;post-time&quot;&gt;</span><br><span class="line">    &amp;nbsp; | &amp;nbsp;</span><br><span class="line">    &lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class="line">      &lt;i class&#x3D;&quot;fa fa-hourglass-half&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">      &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;  阅读时长: &lt;&#x2F;span&gt;</span><br><span class="line">      &lt;span class&#x3D;&quot;post-count&quot;&gt;&lt;%&#x3D; min2read(post.content) %&gt;分&lt;&#x2F;span&gt;</span><br><span class="line">    &lt;&#x2F;span&gt;</span><br><span class="line">  &lt;&#x2F;span&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>然后在 <code>themes/yelee/layout/_partial/article.ejs</code>中添加</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;article-inner&quot;&gt;</span><br><span class="line">    &lt;% if (theme.fancybox)&#123; %&gt;</span><br><span class="line">      &lt;input type&#x3D;&quot;hidden&quot; class&#x3D;&quot;isFancy&quot; &#x2F;&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">    &lt;% if (post.link || post.title)&#123; %&gt;</span><br><span class="line">      &lt;header class&#x3D;&quot;article-header&quot;&gt;</span><br><span class="line">        &lt;%- partial(&#39;post&#x2F;title&#39;, &#123;class_name: &#39;article-title&#39;&#125;) %&gt;</span><br><span class="line">        &lt;!-- 开始添加字数统计,这里才是添加的东西--&gt;</span><br><span class="line">        &lt;% if(theme.word_count &amp;&amp; !post.no_word_count)&#123;%&gt;</span><br><span class="line">          &lt;%- partial(&#39;post&#x2F;word&#39;) %&gt;</span><br><span class="line">          &lt;% &#125; %&gt;</span><br><span class="line">         &lt;!-- 添加完成 --&gt;</span><br><span class="line">      &lt;&#x2F;header&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>开启功能</li></ol><p>在yelee主题的<code>_config.yml</code>中添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">word_count:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="254-配置本地搜索"><a class="markdownIt-Anchor" href="#254-配置本地搜索"></a> 2.5.4 配置本地搜索</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 项目根目录运行</span></span><br><span class="line">npm install hexo<span class="literal">-generator</span><span class="literal">-search</span> -<span class="literal">-save</span></span><br></pre></td></tr></table></figure><p>然后配置文件<code>themes/yelee/_config.yml</code>中修改为：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">search:</span> </span><br><span class="line">  <span class="attr">on:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onload:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment">## true: get search.xml file when the page has loaded</span></span><br><span class="line">  <span class="comment">## false: get the file when search box gets focus</span></span><br></pre></td></tr></table></figure><h3 id="255-添加网站运行时间"><a class="markdownIt-Anchor" href="#255-添加网站运行时间"></a> 2.5.5 添加网站运行时间</h3><p><code>\themes\yelee\layout\_partial</code>路径下找到<code>footer.ejs</code>添加如下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;footer id&#x3D;&quot;footer&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;outer&quot;&gt;</span><br><span class="line">    &lt;div id&#x3D;&quot;footer-info&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;footer-left&quot;&gt; &lt;&#x2F;div&gt;</span><br><span class="line">      &lt;!--添加代码的位置,以及要添加的代码</span><br><span class="line">&lt;span id&#x3D;&quot;timeDate&quot;&gt;载入天数...&lt;&#x2F;span&gt;&lt;span id&#x3D;&quot;times&quot;&gt;载入时分秒...&lt;&#x2F;span&gt;</span><br><span class="line">      &lt;script&gt;</span><br><span class="line">        var now &#x3D; new Date();</span><br><span class="line">        function createtime() &#123;</span><br><span class="line">          var grt &#x3D; new Date(&quot;09&#x2F;13&#x2F;2020 12:49:00&quot;);&#x2F;&#x2F;此处修改你的建站时间或者网站上线时间 </span><br><span class="line">          now.setTime(now.getTime() + 250);</span><br><span class="line">          days &#x3D; (now - grt) &#x2F; 1000 &#x2F; 60 &#x2F; 60 &#x2F; 24; dnum &#x3D; Math.floor(days);</span><br><span class="line">          hours &#x3D; (now - grt) &#x2F; 1000 &#x2F; 60 &#x2F; 60 - (24 * dnum); hnum &#x3D; Math.floor(hours);</span><br><span class="line">          if (String(hnum).length &#x3D;&#x3D; 1) &#123; hnum &#x3D; &quot;0&quot; + hnum; &#125; minutes &#x3D; (now - grt) &#x2F; 1000 &#x2F; 60 - (24 * 60 * dnum) - (60 * hnum);</span><br><span class="line">          mnum &#x3D; Math.floor(minutes); if (String(mnum).length &#x3D;&#x3D; 1) &#123; mnum &#x3D; &quot;0&quot; + mnum; &#125;</span><br><span class="line">          seconds &#x3D; (now - grt) &#x2F; 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);</span><br><span class="line">          snum &#x3D; Math.round(seconds); if (String(snum).length &#x3D;&#x3D; 1) &#123; snum &#x3D; &quot;0&quot; + snum; &#125;</span><br><span class="line">          document.getElementById(&quot;timeDate&quot;).innerHTML &#x3D; &quot;本站已安全运行 &quot; + dnum + &quot; 天 &quot;;</span><br><span class="line">          document.getElementById(&quot;times&quot;).innerHTML &#x3D; hnum + &quot; 小时 &quot; + mnum + &quot; 分 &quot; + snum + &quot; 秒&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        setInterval(&quot;createtime()&quot;, 250);</span><br><span class="line">      &lt;&#x2F;script&gt;</span><br><span class="line">--&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;footer-right&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    ……</span><br><span class="line">&lt;&#x2F;footer&gt;</span><br></pre></td></tr></table></figure><h3 id="256-url持久化"><a class="markdownIt-Anchor" href="#256-url持久化"></a> 2.5.6 Url持久化</h3><p>可以发现 hexo 默认生成的文章地址路径是 【网站名称／年／月／日／文章名称】。</p><p>这种链接对搜索爬虫是很不友好的，它的 url 结构超过了三层，太深了。</p><p>安装 <code>hexo-abbrlink</code> 插件：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo<span class="literal">-abbrlink</span> -<span class="literal">-save</span></span><br></pre></td></tr></table></figure><p>然后配置根目录的_config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">:title/</span></span><br><span class="line"><span class="comment">#permalink: :year/:month/:day/:title/</span></span><br></pre></td></tr></table></figure><h3 id="257-添加二次元虚拟人物"><a class="markdownIt-Anchor" href="#257-添加二次元虚拟人物"></a> 2.5.7 添加二次元虚拟人物</h3><p>获取：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -<span class="literal">-save</span> hexo<span class="literal">-helper</span><span class="literal">-live2d</span></span><br></pre></td></tr></table></figure><p>下载人物模型，<a href="https://www.npmjs.com/package/hexo-helper-live2d">官方</a>：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install live2d<span class="literal">-widget</span><span class="literal">-model</span><span class="literal">-shizuku</span> </span><br><span class="line"><span class="comment"># 对应use: live2d-widget-model-unitychan</span></span><br><span class="line"></span><br><span class="line">npm install live2d<span class="literal">-widget</span><span class="literal">-model</span><span class="literal">-hibiki</span></span><br><span class="line"><span class="comment"># 对应use: live2d-widget-model-hibiki</span></span><br></pre></td></tr></table></figure><p>配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">  <span class="comment">#只需要修改unitychan就可以更换虚拟人物</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-unitychan</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="258-当文章中有图片时"><a class="markdownIt-Anchor" href="#258-当文章中有图片时"></a> 2.5.8 当文章中有图片时</h3><p>图片在博文中十分常见，因博客部署在GitHub上，空间有限，推荐将图片、音频、视频等文件存放在<a href="https://www.qiniu.com/">七牛云</a>这样的地方。</p><h4 id="2581-使用七牛云同步插件"><a class="markdownIt-Anchor" href="#2581-使用七牛云同步插件"></a> 2.5.8.1 使用七牛云同步插件</h4><ol><li><p>注册账号登录，点击对象存储，创建存储空间，并绑定域名，绑定域名参考官网提供的说明</p></li><li><p>hexo安装七牛云同步插件：<code>npm install hexo-qiniu-sync --save</code></p></li><li><p>hexo的配置文件中进行七牛云配置</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#plugins:</span></span><br><span class="line"><span class="comment"># - hexo-qiniu-sync</span></span><br><span class="line"><span class="attr">qiniu:</span></span><br><span class="line">  <span class="attr">offline:</span> <span class="literal">true</span> <span class="comment"># 离线,true会省流量</span></span><br><span class="line">  <span class="attr">sync:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">bucket:</span> <span class="comment">#这里需要填写第一步创建的存储空间的名字</span></span><br><span class="line">  <span class="comment"># 这里将其注释掉，不注释，执行hexo g报错</span></span><br><span class="line">  <span class="comment"># secret_file: sec/qn.json or C:</span></span><br><span class="line">  <span class="comment">#登录自己的七牛云账号，点击右上角的投降，选择密钥管理，可以获得</span></span><br><span class="line">  <span class="attr">access_key:</span> <span class="string">your</span> <span class="string">access_key</span> </span><br><span class="line">  <span class="attr">secret_key:</span> <span class="string">your</span> <span class="string">secret_key</span></span><br><span class="line">  <span class="string">//</span> <span class="string">上传的资源子目录前缀.如设置，需与urlPrefix同步</span></span><br><span class="line">  <span class="attr">dirPrefix:</span> <span class="string">static</span></span><br><span class="line">  <span class="string">//外链前缀，第一步绑定的加速域名</span></span><br><span class="line">  <span class="attr">urlPrefix:</span> <span class="string">http://自己的加速域名/static</span></span><br><span class="line">  <span class="string">//使用默认配置即可</span></span><br><span class="line">  <span class="attr">up_host:</span> <span class="string">http://upload.qiniu.com</span></span><br><span class="line">  <span class="string">//本地目录</span></span><br><span class="line">  <span class="attr">local_dir:</span> <span class="string">static</span></span><br><span class="line">  <span class="string">//</span> <span class="string">是否更新已经上传过的文件(仅文件大小不同或在上次上传后进行更新的才会重新上传)</span></span><br><span class="line">  <span class="attr">update_exist:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">image:</span> </span><br><span class="line">    <span class="attr">folder:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">extend:</span> </span><br><span class="line">  <span class="attr">js:</span></span><br><span class="line">    <span class="attr">folder:</span> <span class="string">js</span></span><br><span class="line">  <span class="attr">css:</span></span><br><span class="line">    <span class="attr">folder:</span> <span class="string">css</span></span><br></pre></td></tr></table></figure></li><li><p>在hexo根目录下创建如下目录结构，之后将对应的想要存放到七牛云的文件放到对应的文件夹即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">static</span><br><span class="line">  - images</span><br><span class="line">  - js</span><br><span class="line">  - css</span><br></pre></td></tr></table></figure></li><li><p>在文章中插入图片</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% qnimg 图片.图片格式 title: alt: &#39;class:&#39; extend:?imageView2&#x2F;2&#x2F;w&#x2F;450 %&#125;</span><br></pre></td></tr></table></figure></li><li><p>将本地static目录下的文件同步到七牛云</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo qiniu sync</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu s</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu sync2</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">hexo qiniu s2</span><br></pre></td></tr></table></figure></li></ol><h4 id="2582-使用picgo工具"><a class="markdownIt-Anchor" href="#2582-使用picgo工具"></a> 2.5.8.2 使用picGo工具</h4><p>同步插件在使用过程中发现，在文章使用过程中看不到预览，并且在生成过程中还是会把图片放到public目录，所以会推荐使用<a href="https://pan.baidu.com/s/1RPdP03TrigJTZgmzVs9Dgg">picGo，提取码cdef</a>工具来上传，成功后会返回外链地址，方便使用。</p><h3 id="259-文章底部不显示作者"><a class="markdownIt-Anchor" href="#259-文章底部不显示作者"></a> 2.5.9 文章底部不显示作者</h3><p>倘若出现了这种情况，可以在主题的配置文件中添加：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">author:</span> <span class="string">作者名字</span></span><br></pre></td></tr></table></figure><h3 id="2510-添加点击爱心效果"><a class="markdownIt-Anchor" href="#2510-添加点击爱心效果"></a> 2.5.10 添加点击爱心效果</h3><ul><li><p>下载js文件，<a href="https://pan.baidu.com/s/1dKH_FBNNGjdkTF3PslJkKQ">链接地址,密码bcde</a></p></li><li><p>在<code>theme/yelee/source</code>下创建<code>resources目录</code>并将js文件拷贝到此目录下</p></li><li><p>在<code>/themes/yelee/layout/_partial/after-footer.ejs</code>下添加代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;resources&#x2F;float.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;resources&#x2F;love.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; color&#x3D;0,104,183 opacity&#x3D;1 zindex&#x3D;-1 count&#x3D;50 src&#x3D;&quot;&#x2F;resources&#x2F;particle.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;&#x2F;resources&#x2F;typewriter.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2511-其它"><a class="markdownIt-Anchor" href="#2511-其它"></a> 2.5.11 其它</h3><p>主题文件的_config.yml还可以配置什么：</p><ul><li>网站的ico图标</li><li>自己的头像</li><li>导航栏链接</li><li>背景图片</li><li>是否开启分享</li><li>是否需要评论、以及是否显示评论数量</li><li>文章的标题风格、字体大小</li><li>……</li></ul><h1 id="3-把本地的博客内容同步到-github-上"><a class="markdownIt-Anchor" href="#3-把本地的博客内容同步到-github-上"></a> 3. 把本地的博客内容同步到 Github 上</h1><p>因为博客托管在GitHub上，所以在建立博客仓库时，仓库的名字需要命名为：<code>用户名.github.io</code>这样就可以通过<code>用户名.github.io</code>来访问该站点了。</p><ol><li><p>创建好仓库后，需要本地生成SSH秘钥，方便通过git来进行提交</p></li><li><p>命令行输入：<code>ssh-keygen -t rsa -C &quot;你的邮箱地址&quot;</code>,之后不停的回车，期间，留意秘钥保存的路径，一般是：<code>C:\Users\你的计算机用户名\.ssh</code>，会生成两个文件：</p><ul><li>私钥：<code>id_rsa</code></li><li>公钥：<code>id_rsa.pub</code></li></ul></li><li><p>访问自己GitHub账户的setting/SSH keys，将公钥的内容复制粘贴到Key的位置（主义末尾不要留有空行），title内容随意。</p></li><li><p>安装两个跟部署相关的 hexo 插件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo <span class="literal">-server</span> -<span class="literal">-save</span></span><br><span class="line">npm install hexo<span class="literal">-deployer</span><span class="literal">-git</span> -<span class="literal">-save</span></span><br></pre></td></tr></table></figure></li><li><p>编辑全局的hexo配置文件：_config.xml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site 这一块区域主要是设置博客的主要说明，需要注意的是：每个冒号后面都是有一个空格，然后再书写自己的内容的s</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">LearnFoever</span>  <span class="comment">#网站标题</span></span><br><span class="line"><span class="attr">subtitle:</span>  <span class="comment">#网站副标题</span></span><br><span class="line"><span class="attr">description:</span> <span class="comment">#描述</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">silverbeats</span></span><br><span class="line"><span class="attr">email:</span> <span class="number">418116014</span><span class="string">@qq.com</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span>   <span class="comment">#网站时区。Hexo 默认使用您电脑的时区</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL 这一块一般可以设置的是 url 这个参数，比如我要设置绑定域名的，这里就需要填写我的域名信息</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as &#x27;http://yoursite.com/child&#x27; and root as &#x27;/child/&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">http://silverbeats.github.io</span> <span class="comment">#倘若已经购买了域名的话可以填买的域名</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="comment">#这里配置的url持久化</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:title/</span> <span class="comment">#:year/:month/:day/:title/ </span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span> <span class="comment">#源文件夹，这个文件夹用来存放内容。</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span> <span class="comment">#公共文件夹，这个文件夹用于存放生成的站点文件</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span> <span class="comment">#标签文件夹</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span> <span class="comment">#归档文件夹</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span> <span class="comment">#分类文件夹</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span> <span class="comment">#nclude code 文件夹</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span> <span class="comment">#国际化（i18n）文件夹</span></span><br><span class="line"><span class="attr">skip_render:</span>  <span class="comment">#跳过指定文件的渲染，可使用 glob 表达式来匹配路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment">#新建文章默认文件名</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span> <span class="comment"># 默认布局</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># 在新标签中打开一个外部链接，默认为true</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span> </span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span> <span class="comment">#是否渲染_drafts目录下的文章，默认为false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span> <span class="comment">#启动 Asset 文件夹</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span> <span class="comment">#把链接改为与根目录的相对位址，默认false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span> <span class="comment">#显示未来的文章，默认false</span></span><br><span class="line"><span class="attr">highlight:</span>  <span class="comment">#代码块的设置</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">prismjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">preprocess:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = &#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line"><span class="comment"># Category &amp; Tag #分类和标签的设置</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span> <span class="comment">#默认分类</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Metadata elements</span></span><br><span class="line"><span class="comment">## https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta</span></span><br><span class="line"><span class="attr">meta_generator:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"><span class="comment">## updated_option supports &#x27;mtime&#x27;, &#x27;date&#x27;, &#x27;empty&#x27;</span></span><br><span class="line"><span class="attr">updated_option:</span> <span class="string">&#x27;mtime&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Include / Exclude file(s)</span></span><br><span class="line"><span class="comment">## include:/exclude: options only apply to the &#x27;source/&#x27; folder</span></span><br><span class="line"><span class="attr">include:</span></span><br><span class="line"><span class="attr">exclude:</span></span><br><span class="line"><span class="attr">ignore:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">yelee</span> <span class="comment"># next  yelee</span></span><br><span class="line"></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">all</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## 这里是重点，这里是修改发布地址，因为我们前面已经加了 SSH 密钥信息在 Github 设置里面了，所以只要我们电脑里面持有那两个密钥文件就可以无需密码地跟 Github 做同步。</span></span><br><span class="line"><span class="comment">## 需要注意的是这里的 repo 采用的是 ssh 的地址，而不是 https 的。分支我们默认采用 master 分支，以后熟悉了要换其他也无所谓。</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span></span><br><span class="line">      <span class="attr">github:</span> <span class="string">git@github.com:SilverBeats/SilverBeats.github.io.git,master</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hexo-neat 对静态文件进行压缩</span></span><br><span class="line"><span class="attr">neat_enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">neat_html:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span>  </span><br><span class="line"><span class="attr">neat_css:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;*.min.css&#x27;</span></span><br><span class="line"><span class="attr">neat_js:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mangle:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">output:</span></span><br><span class="line">  <span class="attr">compress:</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;*.min.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#萌妹子</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-hibiki</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> git </tag>
            
            <tag> github </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
